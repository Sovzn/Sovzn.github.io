<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="Sovzn"><meta name="copyright" content="Sovzn"><meta name="generator" content="Hexo 5.3.0"><meta name="theme" content="hexo-theme-yun"><title>RabbitMQ | å¤§å¸ˆå…„</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.22/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#6200ee"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"sovzn.github.io","root":"/","title":"å¤§å¸ˆå…„çš„å°ç ´ç«™","version":"1.3.0","mode":"auto","copycode":true,"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><meta name="description" content="MQå¼•è¨€ä»€ä¹ˆæ˜¯MQMQ(Message Quene) :  ç¿»è¯‘ä¸º æ¶ˆæ¯é˜Ÿåˆ—,é€šè¿‡å…¸å‹çš„ ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å‹,ç”Ÿäº§è€…ä¸æ–­å‘æ¶ˆæ¯é˜Ÿåˆ—ä¸­ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä¸æ–­çš„ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ã€‚å› ä¸ºæ¶ˆæ¯çš„ç”Ÿäº§å’Œæ¶ˆè´¹éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œè€Œä¸”åªå…³å¿ƒæ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶ï¼Œæ²¡æœ‰ä¸šåŠ¡é€»è¾‘çš„ä¾µå…¥,è½»æ¾çš„å®ç°ç³»ç»Ÿé—´è§£è€¦ã€‚åˆ«åä¸º æ¶ˆæ¯ä¸­é—´ä»¶    é€šè¿‡åˆ©ç”¨é«˜æ•ˆå¯é çš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶è¿›è¡Œå¹³å°æ— å…³çš„æ•°æ®äº¤æµï¼Œå¹¶åŸºäºæ•°æ®é€šä¿¡æ¥è¿›è¡Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„é›†æˆã€‚ MQæœ‰">
<meta property="og:type" content="article">
<meta property="og:title" content="RabbitMQ">
<meta property="og:url" content="http://sovzn.github.io/2023/07/29/RabbitMQ/index.html">
<meta property="og:site_name" content="å¤§å¸ˆå…„">
<meta property="og:description" content="MQå¼•è¨€ä»€ä¹ˆæ˜¯MQMQ(Message Quene) :  ç¿»è¯‘ä¸º æ¶ˆæ¯é˜Ÿåˆ—,é€šè¿‡å…¸å‹çš„ ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å‹,ç”Ÿäº§è€…ä¸æ–­å‘æ¶ˆæ¯é˜Ÿåˆ—ä¸­ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä¸æ–­çš„ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ã€‚å› ä¸ºæ¶ˆæ¯çš„ç”Ÿäº§å’Œæ¶ˆè´¹éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œè€Œä¸”åªå…³å¿ƒæ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶ï¼Œæ²¡æœ‰ä¸šåŠ¡é€»è¾‘çš„ä¾µå…¥,è½»æ¾çš„å®ç°ç³»ç»Ÿé—´è§£è€¦ã€‚åˆ«åä¸º æ¶ˆæ¯ä¸­é—´ä»¶    é€šè¿‡åˆ©ç”¨é«˜æ•ˆå¯é çš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶è¿›è¡Œå¹³å°æ— å…³çš„æ•°æ®äº¤æµï¼Œå¹¶åŸºäºæ•°æ®é€šä¿¡æ¥è¿›è¡Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„é›†æˆã€‚ MQæœ‰">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://sovzn.github.io/img/image-20190925220343521.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20190925222230260-3836271.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20190925222329200-3836312.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20190926194738708-3836601.png">
<meta property="og:image" content="http://sovzn.github.io/img/Snipaste_2023-07-29_17-26-03.png">
<meta property="og:image" content="http://sovzn.github.io/img">
<meta property="og:image" content="http://sovzn.github.io/img/Snipaste_2023-07-29_20-55-14.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20191126163023153.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20191126163506795.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20191126163631889.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20200312140114784.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20191126165434784.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20191126165459282.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20191126165840602.png">
<meta property="og:image" content="http://sovzn.github.io/img/Snipaste_2023-07-30_15-17-57.png">
<meta property="og:image" content="http://sovzn.github.io/img/Snipaste_2023-07-30_15-37-26.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20200314221002008.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20191126213115873.png">
<meta property="og:image" content="http://sovzn.github.io/img/Snipaste_2023-08-12_16-12-36.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20191126220145375.png">
<meta property="og:image" content="http://sovzn.github.io/img/image-20191127121900255.png">
<meta property="article:published_time" content="2023-07-29T05:30:35.000Z">
<meta property="article:modified_time" content="2023-08-12T09:46:25.779Z">
<meta property="article:author" content="Sovzn">
<meta property="article:tag" content="RabbitMQ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://sovzn.github.io/img/image-20190925220343521.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Sovzn"><img width="96" loading="lazy" src="/Yun.png" alt="Sovzn"><span class="site-author-status" title="æ°¸è¿œç›¸ä¿¡ç¾å¥½çš„äº‹æƒ…å³å°†å‘ç”Ÿ">ğŸ˜Š</span></a><div class="site-author-name"><a href="/about/">Sovzn</a></div><a class="site-name" href="/about/site.html">å¤§å¸ˆå…„</a><sub class="site-subtitle"></sub><div class="site-desciption">æˆ‘åªæ‹¥æœ‰ä½ çš„æœˆå…‰,æˆ‘è¦æŠŠå®ƒå½“ä½œéª„é˜³ã€‚</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">89</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">30</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">19</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="æ–‡æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="http://wpa.qq.com/msgrd?v=3&amp;uin=&amp;site=qq&amp;menu=yes" title="QQ" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="å¾®åš" target="_blank" style="color:#E6162D"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-weibo-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="è±†ç“£" target="_blank" style="color:#007722"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-douban-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="çŸ¥ä¹" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="å“”å“©å“”å“©" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="Telegram Channel" target="_blank" style="color:#0088CC"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-telegram-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-send-plane-2-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/null" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MQ%E5%BC%95%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">MQå¼•è¨€</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFMQ"><span class="toc-number">1.1.</span> <span class="toc-text">ä»€ä¹ˆæ˜¯MQ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MQ%E6%9C%89%E5%93%AA%E4%BA%9B"><span class="toc-number">1.2.</span> <span class="toc-text">MQæœ‰å“ªäº›</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%90%8CMQ%E7%89%B9%E7%82%B9"><span class="toc-number">1.3.</span> <span class="toc-text">ä¸åŒMQç‰¹ç‚¹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RabbitMQ-%E7%9A%84%E5%BC%95%E8%A8%80"><span class="toc-number">2.</span> <span class="toc-text">RabbitMQ çš„å¼•è¨€</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RabbitMQ"><span class="toc-number">2.1.</span> <span class="toc-text">RabbitMQ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RabbitMQ-%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-number">2.2.</span> <span class="toc-text">RabbitMQ çš„å®‰è£…</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD"><span class="toc-number">2.2.1.</span> <span class="toc-text">ä¸‹è½½</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%AE%89%E8%A3%85%E5%8C%85"><span class="toc-number">2.2.2.</span> <span class="toc-text">ä¸‹è½½çš„å®‰è£…åŒ…</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.2.3.</span> <span class="toc-text">å®‰è£…æ­¥éª¤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RabiitMQ-%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">RabiitMQ é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RabbitMQ-%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4%E8%A1%8C"><span class="toc-number">3.1.</span> <span class="toc-text">RabbitMQ ç®¡ç†å‘½ä»¤è¡Œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.2.</span> <span class="toc-text">webç®¡ç†ç•Œé¢ä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Admin%E7%94%A8%E6%88%B7%E5%92%8C%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E7%AE%A1%E7%90%86"><span class="toc-number">3.2.1.</span> <span class="toc-text">Adminç”¨æˆ·å’Œè™šæ‹Ÿä¸»æœºç®¡ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7"><span class="toc-number">3.2.1.1.</span> <span class="toc-text">æ·»åŠ ç”¨æˆ·</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA"><span class="toc-number">3.2.1.2.</span> <span class="toc-text">åˆ›å»ºè™šæ‹Ÿä¸»æœº</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%91%E5%AE%9A%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E5%92%8C%E7%94%A8%E6%88%B7"><span class="toc-number">3.2.1.3.</span> <span class="toc-text">ç»‘å®šè™šæ‹Ÿä¸»æœºå’Œç”¨æˆ·</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RabbitMQ-%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%A8%8B%E5%BA%8F"><span class="toc-number">4.</span> <span class="toc-text">RabbitMQ çš„ç¬¬ä¸€ä¸ªç¨‹åº</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AMQP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%9B%9E%E9%A1%BE"><span class="toc-number">4.1.</span> <span class="toc-text">AMQPåè®®çš„å›é¡¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RabbitMQ%E6%94%AF%E6%8C%81%E7%9A%84%E6%B6%88%E6%81%AF%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.2.</span> <span class="toc-text">RabbitMQæ”¯æŒçš„æ¶ˆæ¯æ¨¡å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="toc-number">4.3.</span> <span class="toc-text">å¼•å…¥ä¾èµ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%A8%A1%E5%9E%8B-%E7%9B%B4%E8%BF%9E"><span class="toc-number">4.4.</span> <span class="toc-text">ç¬¬ä¸€ç§æ¨¡å‹(ç›´è¿)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%BC%80%E5%8F%91%E7%94%9F%E4%BA%A7%E8%80%85"><span class="toc-number">4.4.0.1.</span> <span class="toc-text">1. å¼€å‘ç”Ÿäº§è€…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%BC%80%E5%8F%91%E6%B6%88%E8%B4%B9%E8%80%85"><span class="toc-number">4.4.0.2.</span> <span class="toc-text">2. å¼€å‘æ¶ˆè´¹è€…</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%A8%A1%E5%9E%8B-work-quene"><span class="toc-number">4.5.</span> <span class="toc-text">ç¬¬äºŒç§æ¨¡å‹(work quene)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%BC%80%E5%8F%91%E7%94%9F%E4%BA%A7%E8%80%85-1"><span class="toc-number">4.5.0.1.</span> <span class="toc-text">1. å¼€å‘ç”Ÿäº§è€…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%BC%80%E5%8F%91%E6%B6%88%E8%B4%B9%E8%80%85-1"><span class="toc-number">4.5.0.2.</span> <span class="toc-text">2.å¼€å‘æ¶ˆè´¹è€…-1</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E5%BC%80%E5%8F%91%E6%B6%88%E8%B4%B9%E8%80%85-2"><span class="toc-number">4.5.0.3.</span> <span class="toc-text">3.å¼€å‘æ¶ˆè´¹è€…-2</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C"><span class="toc-number">4.5.0.4.</span> <span class="toc-text">4.æµ‹è¯•ç»“æœ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-%E6%B6%88%E6%81%AF%E8%87%AA%E5%8A%A8%E7%A1%AE%E8%AE%A4%E6%9C%BA%E5%88%B6"><span class="toc-number">4.5.0.5.</span> <span class="toc-text">5.æ¶ˆæ¯è‡ªåŠ¨ç¡®è®¤æœºåˆ¶</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%A7%8D%E6%A8%A1%E5%9E%8B-fanout"><span class="toc-number">4.6.</span> <span class="toc-text">ç¬¬ä¸‰ç§æ¨¡å‹(fanout)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%BC%80%E5%8F%91%E7%94%9F%E4%BA%A7%E8%80%85-2"><span class="toc-number">4.6.0.1.</span> <span class="toc-text">1. å¼€å‘ç”Ÿäº§è€…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%BC%80%E5%8F%91%E6%B6%88%E8%B4%B9%E8%80%85-1-1"><span class="toc-number">4.6.0.2.</span> <span class="toc-text">2. å¼€å‘æ¶ˆè´¹è€…-1</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E5%BC%80%E5%8F%91%E6%B6%88%E8%B4%B9%E8%80%85-2-1"><span class="toc-number">4.6.0.3.</span> <span class="toc-text">3. å¼€å‘æ¶ˆè´¹è€…-2</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E5%BC%80%E5%8F%91%E6%B6%88%E8%B4%B9%E8%80%85-3"><span class="toc-number">4.6.0.4.</span> <span class="toc-text">4.å¼€å‘æ¶ˆè´¹è€…-3</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C"><span class="toc-number">4.6.0.5.</span> <span class="toc-text">5. æµ‹è¯•ç»“æœ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%A7%8D%E6%A8%A1%E5%9E%8B-Routing"><span class="toc-number">4.7.</span> <span class="toc-text">ç¬¬å››ç§æ¨¡å‹(Routing)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Routing-%E4%B9%8B%E8%AE%A2%E9%98%85%E6%A8%A1%E5%9E%8B-Direct-%E7%9B%B4%E8%BF%9E"><span class="toc-number">4.7.1.</span> <span class="toc-text">Routing ä¹‹è®¢é˜…æ¨¡å‹-Direct(ç›´è¿)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%BC%80%E5%8F%91%E7%94%9F%E4%BA%A7%E8%80%85-3"><span class="toc-number">4.7.1.1.</span> <span class="toc-text">1. å¼€å‘ç”Ÿäº§è€…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%BC%80%E5%8F%91%E6%B6%88%E8%B4%B9%E8%80%85-1-2"><span class="toc-number">4.7.1.2.</span> <span class="toc-text">2.å¼€å‘æ¶ˆè´¹è€…-1</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E5%BC%80%E5%8F%91%E6%B6%88%E8%B4%B9%E8%80%85-2-2"><span class="toc-number">4.7.1.3.</span> <span class="toc-text">3.å¼€å‘æ¶ˆè´¹è€…-2</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C-1"><span class="toc-number">4.7.1.4.</span> <span class="toc-text">4.æµ‹è¯•ç»“æœ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Routing-%E4%B9%8B%E8%AE%A2%E9%98%85%E6%A8%A1%E5%9E%8B-Topic"><span class="toc-number">4.7.2.</span> <span class="toc-text">Routing ä¹‹è®¢é˜…æ¨¡å‹-Topic</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%BC%80%E5%8F%91%E7%94%9F%E4%BA%A7%E8%80%85-4"><span class="toc-number">4.7.2.1.</span> <span class="toc-text">1.å¼€å‘ç”Ÿäº§è€…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%BC%80%E5%8F%91%E6%B6%88%E8%B4%B9%E8%80%85-1-3"><span class="toc-number">4.7.2.2.</span> <span class="toc-text">2.å¼€å‘æ¶ˆè´¹è€…-1</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E5%BC%80%E5%8F%91%E6%B6%88%E8%B4%B9%E8%80%85-2-3"><span class="toc-number">4.7.2.3.</span> <span class="toc-text">3.å¼€å‘æ¶ˆè´¹è€…-2</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C-2"><span class="toc-number">4.7.2.4.</span> <span class="toc-text">4.æµ‹è¯•ç»“æœ</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://Sovzn.github.io/2023/07/29/RabbitMQ/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Sovzn"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="å¤§å¸ˆå…„"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">RabbitMQ</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="Created: 2023-07-29 13:30:35" itemprop="dateCreated datePublished" datetime="2023-07-29T13:30:35+08:00">2023-07-29</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="Modified: 2023-08-12 17:46:25" itemprop="dateModified" datetime="2023-08-12T17:46:25+08:00">2023-08-12</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">åˆ†å¸ƒå¼</span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/RabbitMQ/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">RabbitMQ</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/RabbitMQ/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">RabbitMQ</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#6200ee;"><h2 id="MQå¼•è¨€"><a href="#MQå¼•è¨€" class="headerlink" title="MQå¼•è¨€"></a>MQå¼•è¨€</h2><h3 id="ä»€ä¹ˆæ˜¯MQ"><a href="#ä»€ä¹ˆæ˜¯MQ" class="headerlink" title="ä»€ä¹ˆæ˜¯MQ"></a>ä»€ä¹ˆæ˜¯MQ</h3><p><code>MQ</code>(Message Quene) :  ç¿»è¯‘ä¸º <code>æ¶ˆæ¯é˜Ÿåˆ—</code>,é€šè¿‡å…¸å‹çš„ <code>ç”Ÿäº§è€…</code>å’Œ<code>æ¶ˆè´¹è€…</code>æ¨¡å‹,ç”Ÿäº§è€…ä¸æ–­å‘æ¶ˆæ¯é˜Ÿåˆ—ä¸­ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä¸æ–­çš„ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ã€‚å› ä¸ºæ¶ˆæ¯çš„ç”Ÿäº§å’Œæ¶ˆè´¹éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œè€Œä¸”åªå…³å¿ƒæ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶ï¼Œæ²¡æœ‰ä¸šåŠ¡é€»è¾‘çš„ä¾µå…¥,è½»æ¾çš„å®ç°ç³»ç»Ÿé—´è§£è€¦ã€‚åˆ«åä¸º <code>æ¶ˆæ¯ä¸­é—´ä»¶</code>    é€šè¿‡åˆ©ç”¨é«˜æ•ˆå¯é çš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶è¿›è¡Œå¹³å°æ— å…³çš„æ•°æ®äº¤æµï¼Œå¹¶åŸºäºæ•°æ®é€šä¿¡æ¥è¿›è¡Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„é›†æˆã€‚</p>
<h3 id="MQæœ‰å“ªäº›"><a href="#MQæœ‰å“ªäº›" class="headerlink" title="MQæœ‰å“ªäº›"></a>MQæœ‰å“ªäº›</h3><p>å½“ä»Šå¸‚é¢ä¸Šæœ‰å¾ˆå¤šä¸»æµçš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå¦‚è€ç‰Œçš„<code>ActiveMQ</code>ã€<code>RabbitMQ</code>ï¼Œç‚™æ‰‹å¯çƒ­çš„<code>Kafka</code>ï¼Œé˜¿é‡Œå·´å·´è‡ªä¸»å¼€å‘<code>RocketMQ</code>ç­‰ã€‚</p>
<h3 id="ä¸åŒMQç‰¹ç‚¹"><a href="#ä¸åŒMQç‰¹ç‚¹" class="headerlink" title="ä¸åŒMQç‰¹ç‚¹"></a>ä¸åŒMQç‰¹ç‚¹</h3><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> 1.ActiveMQ</span>
		ActiveMQ æ˜¯Apacheå‡ºå“ï¼Œæœ€æµè¡Œçš„ï¼Œèƒ½åŠ›å¼ºåŠ²çš„å¼€æºæ¶ˆæ¯æ€»çº¿ã€‚å®ƒæ˜¯ä¸€ä¸ªå®Œå…¨æ”¯æŒJMSè§„èŒƒçš„çš„æ¶ˆæ¯ä¸­é—´ä»¶ã€‚ä¸°å¯Œçš„API,å¤šç§é›†ç¾¤æ¶æ„æ¨¡å¼è®©ActiveMQåœ¨ä¸šç•Œæˆä¸ºè€ç‰Œçš„æ¶ˆæ¯ä¸­é—´ä»¶,åœ¨ä¸­å°å‹ä¼ä¸šé¢‡å—æ¬¢è¿!

<span class="token title important"><span class="token punctuation">#</span> 2.Kafka</span>
		Kafkaæ˜¯LinkedInå¼€æºçš„åˆ†å¸ƒå¼å‘å¸ƒ-è®¢é˜…æ¶ˆæ¯ç³»ç»Ÿï¼Œç›®å‰å½’å±äºApacheé¡¶çº§é¡¹ç›®ã€‚Kafkaä¸»è¦ç‰¹ç‚¹æ˜¯åŸºäºPullçš„æ¨¡å¼æ¥å¤„ç†æ¶ˆæ¯æ¶ˆè´¹ï¼Œ
		è¿½æ±‚é«˜ååé‡ï¼Œä¸€å¼€å§‹çš„ç›®çš„å°±æ˜¯ç”¨äºæ—¥å¿—æ”¶é›†å’Œä¼ è¾“ã€‚0.8ç‰ˆæœ¬å¼€å§‹æ”¯æŒå¤åˆ¶ï¼Œä¸æ”¯æŒäº‹åŠ¡ï¼Œå¯¹æ¶ˆæ¯çš„é‡å¤ã€ä¸¢å¤±ã€é”™è¯¯æ²¡æœ‰ä¸¥æ ¼è¦æ±‚ï¼Œ
		é€‚åˆäº§ç”Ÿå¤§é‡æ•°æ®çš„äº’è”ç½‘æœåŠ¡çš„æ•°æ®æ”¶é›†ä¸šåŠ¡ã€‚

<span class="token title important"><span class="token punctuation">#</span> 3.RocketMQ</span>
		RocketMQæ˜¯é˜¿é‡Œå¼€æºçš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå®ƒæ˜¯çº¯Javaå¼€å‘ï¼Œå…·æœ‰é«˜ååé‡ã€é«˜å¯ç”¨æ€§ã€é€‚åˆå¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿåº”ç”¨çš„ç‰¹ç‚¹ã€‚RocketMQæ€è·¯èµ·
		æºäºKafkaï¼Œä½†å¹¶ä¸æ˜¯Kafkaçš„ä¸€ä¸ªCopyï¼Œå®ƒå¯¹æ¶ˆæ¯çš„å¯é ä¼ è¾“åŠäº‹åŠ¡æ€§åšäº†ä¼˜åŒ–ï¼Œç›®å‰åœ¨é˜¿é‡Œé›†å›¢è¢«å¹¿æ³›åº”ç”¨äºäº¤æ˜“ã€å……å€¼ã€æµè®¡ç®—ã€æ¶ˆ
		æ¯æ¨é€ã€æ—¥å¿—æµå¼å¤„ç†ã€binglogåˆ†å‘ç­‰åœºæ™¯ã€‚

<span class="token title important"><span class="token punctuation">#</span> 4.RabbitMQ</span>
		RabbitMQæ˜¯ä½¿ç”¨Erlangè¯­è¨€å¼€å‘çš„å¼€æºæ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿï¼ŒåŸºäºAMQPåè®®æ¥å®ç°ã€‚AMQPçš„ä¸»è¦ç‰¹å¾æ˜¯é¢å‘æ¶ˆæ¯ã€é˜Ÿåˆ—ã€è·¯ç”±ï¼ˆåŒ…æ‹¬ç‚¹å¯¹ç‚¹å’Œ
		å‘å¸ƒ/è®¢é˜…ï¼‰ã€å¯é æ€§ã€å®‰å…¨ã€‚AMQPåè®®æ›´å¤šç”¨åœ¨ä¼ä¸šç³»ç»Ÿå†…å¯¹æ•°æ®ä¸€è‡´æ€§ã€ç¨³å®šæ€§å’Œå¯é æ€§è¦æ±‚å¾ˆé«˜çš„åœºæ™¯ï¼Œå¯¹æ€§èƒ½å’Œååé‡çš„è¦æ±‚è¿˜åœ¨
		å…¶æ¬¡ã€‚
		<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>RabbitMQæ¯”Kafkaå¯é ï¼ŒKafkaæ›´é€‚åˆIOé«˜ååçš„å¤„ç†ï¼Œä¸€èˆ¬åº”ç”¨åœ¨å¤§æ•°æ®æ—¥å¿—å¤„ç†æˆ–å¯¹å®æ—¶æ€§ï¼ˆå°‘é‡å»¶è¿Ÿï¼‰ï¼Œå¯é æ€§ï¼ˆå°‘é‡ä¸¢æ•°æ®ï¼‰è¦æ±‚ç¨ä½çš„åœºæ™¯ä½¿ç”¨ï¼Œæ¯”å¦‚ELKæ—¥å¿—æ”¶é›†ã€‚</p>
</blockquote>
<hr>
<h2 id="RabbitMQ-çš„å¼•è¨€"><a href="#RabbitMQ-çš„å¼•è¨€" class="headerlink" title="RabbitMQ çš„å¼•è¨€"></a>RabbitMQ çš„å¼•è¨€</h2><h3 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h3><blockquote>
<p>åŸºäº<code>AMQP</code>åè®®ï¼Œerlangè¯­è¨€å¼€å‘ï¼Œæ˜¯éƒ¨ç½²æœ€å¹¿æ³›çš„å¼€æºæ¶ˆæ¯ä¸­é—´ä»¶,æ˜¯æœ€å—æ¬¢è¿çš„å¼€æºæ¶ˆæ¯ä¸­é—´ä»¶ä¹‹ä¸€ã€‚</p>
</blockquote>
<pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> AMQP åè®®</span>
		AMQPï¼ˆadvanced message queuing protocolï¼‰`åœ¨2003å¹´æ—¶è¢«æå‡ºï¼Œæœ€æ—©ç”¨äºè§£å†³é‡‘èé¢†ä¸åŒå¹³å°ä¹‹é—´çš„æ¶ˆæ¯ä¼ é€’äº¤äº’é—®é¢˜ã€‚é¡¾åæ€ä¹‰ï¼ŒAMQPæ˜¯ä¸€ç§åè®®ï¼Œæ›´å‡†ç¡®çš„è¯´æ˜¯ä¸€ç§binary wire-level protocolï¼ˆé“¾æ¥åè®®ï¼‰ã€‚è¿™æ˜¯å…¶å’ŒJMSçš„æœ¬è´¨å·®åˆ«ï¼ŒAMQPä¸ä»APIå±‚è¿›è¡Œé™å®šï¼Œè€Œæ˜¯ç›´æ¥å®šä¹‰ç½‘ç»œäº¤æ¢çš„æ•°æ®æ ¼å¼ã€‚è¿™ä½¿å¾—å®ç°äº†AMQPçš„providerå¤©ç„¶æ€§å°±æ˜¯è·¨å¹³å°çš„ã€‚ä»¥ä¸‹æ˜¯AMQPåè®®æ¨¡å‹:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="RabbitMQ-çš„å®‰è£…"><a href="#RabbitMQ-çš„å®‰è£…" class="headerlink" title="RabbitMQ çš„å®‰è£…"></a>RabbitMQ çš„å®‰è£…</h3><h4 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h4><p><code>å®˜ç½‘ä¸‹è½½åœ°å€</code>: <a target="_blank" rel="noopener" href="https://www.rabbitmq.com/download.html![image-20190925220115235](/img/image-20190925220115235.png)">https://www.rabbitmq.com/download.html![image-20190925220115235](/img/image-20190925220115235.png)</a></p>
<blockquote>
<p><code>æœ€æ–°ç‰ˆæœ¬</code>: 3.7.18</p>
</blockquote>
<h4 id="ä¸‹è½½çš„å®‰è£…åŒ…"><a href="#ä¸‹è½½çš„å®‰è£…åŒ…" class="headerlink" title="ä¸‹è½½çš„å®‰è£…åŒ…"></a>ä¸‹è½½çš„å®‰è£…åŒ…</h4><p><img src="/img/image-20190925220343521.png" alt="image-20190925220343521" loading="lazy"></p>
<blockquote>
<p><code>æ³¨æ„</code>:è¿™é‡Œçš„å®‰è£…åŒ…æ˜¯centos7å®‰è£…çš„åŒ…</p>
</blockquote>
<h4 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h4><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> 1.å°†rabbitmqå®‰è£…åŒ…ä¸Šä¼ åˆ°linuxç³»ç»Ÿä¸­</span>
	erlang-22.0.7-1.el7.x86_64.rpm
	rabbitmq-server-3.7.18-1.el7.noarch.rpm

<span class="token title important"><span class="token punctuation">#</span> 2.å®‰è£…Erlangä¾èµ–åŒ…</span>
	rpm -ivh erlang-22.0.7-1.el7.x86_64.rpm

<span class="token title important"><span class="token punctuation">#</span> 3.å®‰è£…RabbitMQå®‰è£…åŒ…(éœ€è¦è”ç½‘)</span>
	yum install -y rabbitmq-server-3.7.18-1.el7.noarch.rpm
		æ³¨æ„:é»˜è®¤å®‰è£…å®Œæˆåé…ç½®æ–‡ä»¶æ¨¡æ¿åœ¨:/usr/share/doc/rabbitmq-server-3.7.18/rabbitmq.config.exampleç›®å½•ä¸­,éœ€è¦	
				å°†é…ç½®æ–‡ä»¶å¤åˆ¶åˆ°/etc/rabbitmq/ç›®å½•ä¸­,å¹¶ä¿®æ”¹åç§°ä¸ºrabbitmq.config
<span class="token title important"><span class="token punctuation">#</span> 4.å¤åˆ¶é…ç½®æ–‡ä»¶</span>
	cp /usr/share/doc/rabbitmq-server-3.7.18/rabbitmq.config.example /etc/rabbitmq/rabbitmq.config

<span class="token title important"><span class="token punctuation">#</span> 5.æŸ¥çœ‹é…ç½®æ–‡ä»¶ä½ç½®</span>
	ls /etc/rabbitmq/rabbitmq.config

<span class="token title important"><span class="token punctuation">#</span> 6.ä¿®æ”¹é…ç½®æ–‡ä»¶(å‚è§ä¸‹å›¾:)</span>
	vim /etc/rabbitmq/rabbitmq.config <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/img/image-20190925222230260-3836271.png" alt="image-20190925222230260" loading="lazy"></p>
<p>å°†ä¸Šå›¾ä¸­é…ç½®æ–‡ä»¶ä¸­çº¢è‰²éƒ¨åˆ†å»æ‰<code>%%</code>,ä»¥åŠæœ€åçš„<code>,</code>é€—å· ä¿®æ”¹ä¸ºä¸‹å›¾:</p>
<p><img src="/img/image-20190925222329200-3836312.png" alt="image-20190925222329200" loading="lazy"></p>
<p><strong>å¦‚æœä¸ä¿®æ”¹è¿™ä¸ªä¼šå› ä¸ºæƒé™é—®é¢˜æ— æ³•ç™»çš„ï¼Œè¿™ä¸ªå°±æ˜¯å¼€å¯æ¥å®¾è´¦å·guestçš„</strong></p>
<pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> 7.æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤,å¯åŠ¨rabbitmqä¸­çš„æ’ä»¶ç®¡ç†</span>
	rabbitmq-plugins enable rabbitmq_management
	
<span class="token code keyword">	å‡ºç°å¦‚ä¸‹è¯´æ˜:</span>
[root@shiyaochang home]# rabbitmq-plugins enable rabbitmq_management
Enabling plugins on node rabbit@shiyaochang:
rabbitmq_management
The following plugins have been configured:
  rabbitmq_management
  rabbitmq_management_agent
  rabbitmq_web_dispatch
Applying plugin configuration to rabbit@shiyaochang...
The following plugins have been enabled:
  rabbitmq_management
  rabbitmq_management_agent
  rabbitmq_web_dispatch

set 3 plugins.
Offline change; changes will take effect at broker restart.


<span class="token title important"><span class="token punctuation">#</span> 8.å¯åŠ¨RabbitMQçš„æœåŠ¡</span>
	systemctl start rabbitmq-server
	systemctl restart rabbitmq-server
	systemctl stop rabbitmq-server
	

<span class="token title important"><span class="token punctuation">#</span> 9.æŸ¥çœ‹æœåŠ¡çŠ¶æ€(è§ä¸‹å›¾:)</span>
	systemctl status rabbitmq-server
[root@shiyaochang home]# systemctl status rabbitmq-server
â— rabbitmq-server.service - RabbitMQ broker
   Loaded: loaded (/usr/lib/systemd/system/rabbitmq-server.service; disabled; vendor preset: disabled)
   Active: active (running) since Sat 2023-07-29 17:06:50 CST; 10s ago
 Main PID: 22472 (beam.smp)
   Status: "Initialized"
   CGroup: /system.slice/rabbitmq-server.service
           â”œâ”€22472 /usr/lib64/erlang/erts-10.4.4/bin/beam.smp -W w -A 64 -MBas ageffcbf -MHas ageffcbf -MBlmbcs 512 -MHlmbcs 512 -MMmcs 30 -P 1048576 -t 5000000...
           â”œâ”€22800 erl_child_setup 32768
           â”œâ”€22825 inet_gethost 4
           â””â”€22826 inet_gethost 4

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> 10.å…³é—­é˜²ç«å¢™æœåŠ¡(æˆ–è€…å¼€æ”¾ç«¯å£Mqé»˜è®¤ç«¯å£ï¼š15172ï¼ŒæŸäº›æœåŠ¡å™¨è¿˜æœ‰é…ç½®å®‰å…¨ç»„)</span>
1.å…³é—­é˜²ç«å¢™ï¼š
systemctl disable firewalld
Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.
Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.
systemctl stop firewalld   
	

2.å¼€æ”¾ç«¯å£
[root@shiyaochang home]# firewall-cmd --zone=public --add-port=15672/tcp --permanent
success
[root@shiyaochang home]# firewall-cmd --list-ports  # åªçœ‹ç«¯å£ä¿¡æ¯
9090/tcp 80/tcp
[root@shiyaochang home]# systemctl restart firewalld.service  #é‡å¯é˜²ç«å¢™
[root@shiyaochang home]# firewall-cmd --list-ports  # åªçœ‹ç«¯å£ä¿¡æ¯
9090/tcp 80/tcp 15672/tcp
[root@shiyaochang home]# 

<span class="token title important"><span class="token punctuation">#</span> 11.è®¿é—®webç®¡ç†ç•Œé¢</span>
	http://10.15.0.8:15672/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p> <img src="/img/image-20190926194738708-3836601.png" alt="image-20190926194738708" loading="lazy"></p>
<pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> 12.æ¥å®¾è´¦å·</span>
	username:  guest
	password:  guest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="/img/Snipaste_2023-07-29_17-26-03.png" alt="image-20190926194954822" loading="lazy"></p>
<hr>
<h2 id="RabiitMQ-é…ç½®"><a href="#RabiitMQ-é…ç½®" class="headerlink" title="RabiitMQ é…ç½®"></a>RabiitMQ é…ç½®</h2><h3 id="RabbitMQ-ç®¡ç†å‘½ä»¤è¡Œ"><a href="#RabbitMQ-ç®¡ç†å‘½ä»¤è¡Œ" class="headerlink" title="RabbitMQ ç®¡ç†å‘½ä»¤è¡Œ"></a>RabbitMQ ç®¡ç†å‘½ä»¤è¡Œ</h3><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> 1.æœåŠ¡å¯åŠ¨ç›¸å…³</span>
	systemctl start|restart|stop|status rabbitmq-server

<span class="token title important"><span class="token punctuation">#</span> 2.ç®¡ç†å‘½ä»¤è¡Œ  ç”¨æ¥åœ¨ä¸ä½¿ç”¨webç®¡ç†ç•Œé¢æƒ…å†µä¸‹å‘½ä»¤æ“ä½œRabbitMQ</span>
	rabbitmqctl  help  å¯ä»¥æŸ¥çœ‹æ›´å¤šå‘½ä»¤

<span class="token title important"><span class="token punctuation">#</span> 3.æ’ä»¶ç®¡ç†å‘½ä»¤è¡Œ</span>
	rabbitmq-plugins enable|list|disable <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="webç®¡ç†ç•Œé¢ä»‹ç»"><a href="#webç®¡ç†ç•Œé¢ä»‹ç»" class="headerlink" title="webç®¡ç†ç•Œé¢ä»‹ç»"></a>webç®¡ç†ç•Œé¢ä»‹ç»</h3><p><img src="/img" loading="lazy"></p>
<ul>
<li><p><code>connectionsï¼šæ— è®ºç”Ÿäº§è€…è¿˜æ˜¯æ¶ˆè´¹è€…ï¼Œéƒ½éœ€è¦ä¸RabbitMQå»ºç«‹è¿æ¥åæ‰å¯ä»¥å®Œæˆæ¶ˆæ¯çš„ç”Ÿäº§å’Œæ¶ˆè´¹ï¼Œåœ¨è¿™é‡Œå¯ä»¥æŸ¥çœ‹è¿æ¥æƒ…å†µ</code></p>
</li>
<li><p><code>channelsï¼šé€šé“ï¼Œå»ºç«‹è¿æ¥åï¼Œä¼šå½¢æˆé€šé“ï¼Œæ¶ˆæ¯çš„æŠ•é€’è·å–ä¾èµ–é€šé“ã€‚</code></p>
</li>
<li><p><code>Exchangesï¼šäº¤æ¢æœºï¼Œç”¨æ¥å®ç°æ¶ˆæ¯çš„è·¯ç”±</code></p>
</li>
<li><p><code>Queuesï¼šé˜Ÿåˆ—ï¼Œå³æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¶ˆæ¯å­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…æ¶ˆè´¹ï¼Œæ¶ˆè´¹åè¢«ç§»é™¤é˜Ÿåˆ—ã€‚</code></p>
</li>
</ul>
<h4 id="Adminç”¨æˆ·å’Œè™šæ‹Ÿä¸»æœºç®¡ç†"><a href="#Adminç”¨æˆ·å’Œè™šæ‹Ÿä¸»æœºç®¡ç†" class="headerlink" title="Adminç”¨æˆ·å’Œè™šæ‹Ÿä¸»æœºç®¡ç†"></a>Adminç”¨æˆ·å’Œè™šæ‹Ÿä¸»æœºç®¡ç†</h4><h5 id="æ·»åŠ ç”¨æˆ·"><a href="#æ·»åŠ ç”¨æˆ·" class="headerlink" title="æ·»åŠ ç”¨æˆ·"></a>æ·»åŠ ç”¨æˆ·</h5><p><img src="/img/Snipaste_2023-07-29_20-55-14.png" alt="image-20191126162617280" loading="lazy"></p>
<p>æ·»åŠ ç”¨æˆ·çš„Tagsé€‰é¡¹ï¼Œå…¶å®æ˜¯æŒ‡å®šç”¨æˆ·çš„è§’è‰²ï¼Œå¯é€‰çš„æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p>
<ul>
<li><p><code>è¶…çº§ç®¡ç†å‘˜(administrator)</code></p>
<p>å¯ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼Œå¯æŸ¥çœ‹æ‰€æœ‰çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥å¯¹ç”¨æˆ·ï¼Œç­–ç•¥(policy)è¿›è¡Œæ“ä½œã€‚</p>
</li>
<li><p><code>ç›‘æ§è€…(monitoring)</code></p>
<p>å¯ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼ŒåŒæ—¶å¯ä»¥æŸ¥çœ‹rabbitmqèŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯(è¿›ç¨‹æ•°ï¼Œå†…å­˜ä½¿ç”¨æƒ…å†µï¼Œç£ç›˜ä½¿ç”¨æƒ…å†µç­‰)</p>
</li>
<li><p><code>ç­–ç•¥åˆ¶å®šè€…(policymaker)</code></p>
<p>å¯ç™»é™†ç®¡ç†æ§åˆ¶å°, åŒæ—¶å¯ä»¥å¯¹policyè¿›è¡Œç®¡ç†ã€‚ä½†æ— æ³•æŸ¥çœ‹èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯(ä¸Šå›¾çº¢æ¡†æ ‡è¯†çš„éƒ¨åˆ†)ã€‚</p>
</li>
<li><p><code>æ™®é€šç®¡ç†è€…(management)</code></p>
<p>ä»…å¯ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼Œæ— æ³•çœ‹åˆ°èŠ‚ç‚¹ä¿¡æ¯ï¼Œä¹Ÿæ— æ³•å¯¹ç­–ç•¥è¿›è¡Œç®¡ç†ã€‚</p>
</li>
<li><p><code>å…¶ä»–</code></p>
<p>æ— æ³•ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼Œé€šå¸¸å°±æ˜¯æ™®é€šçš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€‚</p>
</li>
</ul>
<h5 id="åˆ›å»ºè™šæ‹Ÿä¸»æœº"><a href="#åˆ›å»ºè™šæ‹Ÿä¸»æœº" class="headerlink" title="åˆ›å»ºè™šæ‹Ÿä¸»æœº"></a>åˆ›å»ºè™šæ‹Ÿä¸»æœº</h5><blockquote>
<p>è™šæ‹Ÿä¸»æœº</p>
</blockquote>
<p>â€‹    <strong>ä¸ºäº†è®©å„ä¸ªç”¨æˆ·å¯ä»¥äº’ä¸å¹²æ‰°çš„å·¥ä½œï¼ŒRabbitMQæ·»åŠ äº†è™šæ‹Ÿä¸»æœºï¼ˆVirtual Hostsï¼‰çš„æ¦‚å¿µã€‚å…¶å®å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è®¿é—®è·¯å¾„ï¼Œä¸åŒç”¨æˆ·ä½¿ç”¨ä¸åŒè·¯å¾„ï¼Œå„è‡ªæœ‰è‡ªå·±çš„é˜Ÿåˆ—ã€äº¤æ¢æœºï¼Œäº’ç›¸ä¸ä¼šå½±å“ã€‚</strong></p>
<p><img src="/img/image-20191126163023153.png" alt="image-20191126163023153" loading="lazy"></p>
<h5 id="ç»‘å®šè™šæ‹Ÿä¸»æœºå’Œç”¨æˆ·"><a href="#ç»‘å®šè™šæ‹Ÿä¸»æœºå’Œç”¨æˆ·" class="headerlink" title="ç»‘å®šè™šæ‹Ÿä¸»æœºå’Œç”¨æˆ·"></a>ç»‘å®šè™šæ‹Ÿä¸»æœºå’Œç”¨æˆ·</h5><p>åˆ›å»ºå¥½è™šæ‹Ÿä¸»æœºï¼Œæˆ‘ä»¬è¿˜è¦ç»™ç”¨æˆ·æ·»åŠ è®¿é—®æƒé™ï¼š</p>
<p>ç‚¹å‡»æ·»åŠ å¥½çš„è™šæ‹Ÿä¸»æœºï¼š</p>
<p> <img src="/img/image-20191126163506795.png" alt="image-20191126163506795" loading="lazy"></p>
<p>è¿›å…¥è™šæ‹Ÿæœºè®¾ç½®ç•Œé¢:</p>
<p><img src="/img/image-20191126163631889.png" alt="image-20191126163631889" loading="lazy"></p>
<hr>
<h2 id="RabbitMQ-çš„ç¬¬ä¸€ä¸ªç¨‹åº"><a href="#RabbitMQ-çš„ç¬¬ä¸€ä¸ªç¨‹åº" class="headerlink" title="RabbitMQ çš„ç¬¬ä¸€ä¸ªç¨‹åº"></a>RabbitMQ çš„ç¬¬ä¸€ä¸ªç¨‹åº</h2><h3 id="AMQPåè®®çš„å›é¡¾"><a href="#AMQPåè®®çš„å›é¡¾" class="headerlink" title="AMQPåè®®çš„å›é¡¾"></a>AMQPåè®®çš„å›é¡¾</h3><p><img src="/img/image-20200312140114784.png" alt="image-20200312140114784" loading="lazy"></p>
<h3 id="RabbitMQæ”¯æŒçš„æ¶ˆæ¯æ¨¡å‹"><a href="#RabbitMQæ”¯æŒçš„æ¶ˆæ¯æ¨¡å‹" class="headerlink" title="RabbitMQæ”¯æŒçš„æ¶ˆæ¯æ¨¡å‹"></a>RabbitMQæ”¯æŒçš„æ¶ˆæ¯æ¨¡å‹</h3><p><img src="/img/image-20191126165434784.png" alt="image-20191126165434784" loading="lazy"></p>
<p><img src="/img/image-20191126165459282.png" alt="image-20191126165459282" loading="lazy"></p>
<h3 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h3><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.rabbitmq<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>amqp-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.7.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ç¬¬ä¸€ç§æ¨¡å‹-ç›´è¿"><a href="#ç¬¬ä¸€ç§æ¨¡å‹-ç›´è¿" class="headerlink" title="ç¬¬ä¸€ç§æ¨¡å‹(ç›´è¿)"></a>ç¬¬ä¸€ç§æ¨¡å‹(ç›´è¿)</h3><p><img src="/img/image-20191126165840602.png" alt="image-20191126165840602" loading="lazy"></p>
<p>åœ¨ä¸Šå›¾çš„æ¨¡å‹ä¸­ï¼Œæœ‰ä»¥ä¸‹æ¦‚å¿µï¼š</p>
<ul>
<li>Pï¼šç”Ÿäº§è€…ï¼Œä¹Ÿå°±æ˜¯è¦å‘é€æ¶ˆæ¯çš„ç¨‹åº</li>
<li>Cï¼šæ¶ˆè´¹è€…ï¼šæ¶ˆæ¯çš„æ¥å—è€…ï¼Œä¼šä¸€ç›´ç­‰å¾…æ¶ˆæ¯åˆ°æ¥ã€‚</li>
<li>queueï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå›¾ä¸­çº¢è‰²éƒ¨åˆ†ã€‚ç±»ä¼¼ä¸€ä¸ªé‚®ç®±ï¼Œå¯ä»¥ç¼“å­˜æ¶ˆæ¯ï¼›ç”Ÿäº§è€…å‘å…¶ä¸­æŠ•é€’æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä»å…¶ä¸­å–å‡ºæ¶ˆæ¯ã€‚</li>
</ul>
<h5 id="1-å¼€å‘ç”Ÿäº§è€…"><a href="#1-å¼€å‘ç”Ÿäº§è€…" class="headerlink" title="1. å¼€å‘ç”Ÿäº§è€…"></a>1. å¼€å‘ç”Ÿäº§è€…</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Provider</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">//ç”Ÿäº§æ¶ˆæ¯</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSendMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">TimeoutException</span> <span class="token punctuation">&#123;</span>

        <span class="token comment">//åˆ›å»ºè¿æ¥mqçš„è¿æ¥å·¥å‚å¯¹è±¡</span>
        <span class="token class-name">ConnectionFactory</span> connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®è¿æ¥rabbitmqä¸»æœº</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">"124.71.207.241"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®ç«¯å£å·</span>
        <span class="token comment">/**
         * æ³¨ï¼šRabbitMqçš„é»˜è®¤é“¾æ¥ç«¯å£æ˜¯5672ï¼ˆæœåŠ¡å™¨è¦æ”¾å¼€è¯¥ç«¯å£ï¼Œå®‰å…¨ç»„é…ç½®ï¼‰
         * webè®¿é—®é»˜è®¤ç«¯å£æ˜¯15672
         * */</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5672</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®è¿æ¥é‚£ä¸ªè™šæ‹Ÿä¸»æœº</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setVirtualHost</span><span class="token punctuation">(</span><span class="token string">"ems"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®è®¿é—®è™šæ‹Ÿä¸»æœºçš„ç”¨æˆ·åå’Œå¯†ç </span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"ems"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è·å–è¿æ¥å¯¹è±¡</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> connectionFactory<span class="token punctuation">.</span><span class="token function">newConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é€šè¿‡å·¥å…·ç±»è·å–è¿æ¥å¯¹è±¡</span>
        <span class="token comment">//Connection connection = RabbitMQUtils.getConnection();</span>
        <span class="token comment">//è·å–è¿æ¥ä¸­é€šé“</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é€šé“ç»‘å®šå¯¹åº”æ¶ˆæ¯é˜Ÿåˆ—</span>
        <span class="token comment">//å‚æ•°1:  é˜Ÿåˆ—åç§° å¦‚æœé˜Ÿåˆ—ä¸å­˜åœ¨è‡ªåŠ¨åˆ›å»º</span>
        <span class="token comment">//å‚æ•°2:  ç”¨æ¥å®šä¹‰é˜Ÿåˆ—ç‰¹æ€§æ˜¯å¦è¦æŒä¹…åŒ– true æŒä¹…åŒ–é˜Ÿåˆ—ï¼ˆé˜Ÿåˆ—ä¸ä¼šéšMqæœåŠ¡çš„é‡å¯è€Œæ¶ˆå¤±ï¼‰   false ä¸æŒä¹…åŒ–</span>
        <span class="token comment">//å‚æ•°3:  exclusive æ˜¯å¦ç‹¬å é˜Ÿåˆ—  true ç‹¬å é˜Ÿåˆ—ï¼ˆå…¶ä»–é€šé“æ— æ³•ç»‘å®šè¯¥é˜Ÿåˆ—ï¼‰   false  ä¸ç‹¬å </span>
        <span class="token comment">//å‚æ•°4:  autoDelete: æ˜¯å¦åœ¨æ¶ˆè´¹å®Œæˆåè‡ªåŠ¨åˆ é™¤é˜Ÿåˆ—  true è‡ªåŠ¨åˆ é™¤  false ä¸è‡ªåŠ¨åˆ é™¤</span>
        <span class="token comment">//å‚æ•°5:  é¢å¤–é™„åŠ å‚æ•°</span>
       channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å‘å¸ƒæ¶ˆæ¯</span>
        <span class="token comment">//å‚æ•°1: äº¤æ¢æœºåç§° å‚æ•°2:é˜Ÿåˆ—åç§°  å‚æ•°3:ä¼ é€’æ¶ˆæ¯é¢å¤–è®¾ç½®  å‚æ•°4:æ¶ˆæ¯çš„å…·ä½“å†…å®¹</span>
        channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span><span class="token string">"hello rabbitmq"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        channel<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è°ƒç”¨å·¥å…·ç±»     //RabbitMQUtils.closeConnectionAndChanel(channel,connection);</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>è¿è¡Œç”Ÿäº§è€…ç¨‹åºProviderï¼Œå°±å¯ä»¥åœ¨webç®¡ç†ç•Œé¢å‘ç°é˜Ÿåˆ—ä¸­å¤šäº†ä¸€æ¡ï¼š</strong></p>
<p><img src="/img/Snipaste_2023-07-30_15-17-57.png" loading="lazy"></p>
<h5 id="2-å¼€å‘æ¶ˆè´¹è€…"><a href="#2-å¼€å‘æ¶ˆè´¹è€…" class="headerlink" title="2. å¼€å‘æ¶ˆè´¹è€…"></a>2. å¼€å‘æ¶ˆè´¹è€…</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">TimeoutException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//åˆ›å»ºè¿æ¥å·¥å‚</span>
        <span class="token class-name">ConnectionFactory</span> connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">"124.71.207.241"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5672</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setVirtualHost</span><span class="token punctuation">(</span><span class="token string">"ems"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"ems"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ›å»ºè¿æ¥å¯¹è±¡</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> connectionFactory<span class="token punctuation">.</span><span class="token function">newConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é€šè¿‡å·¥å…·ç±»è·å–è¿æ¥</span>
        <span class="token comment">//Connection connection = RabbitMQUtils.getConnection();</span>
        <span class="token comment">//åˆ›å»ºé€šé“</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        
        <span class="token comment">//é€šé“ç»‘å®šé˜Ÿåˆ—  </span>
        <span class="token comment">// æ³¨æ„ï¼šç»‘å®šæ—¶çš„å‚æ•°è¦å’Œç”Ÿäº§è€…ç»‘å®šæ—¶çš„å‚æ•°ä¸€è‡´</span>
       channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        
        <span class="token comment">//æ¶ˆè´¹æ¶ˆæ¯ </span>
        <span class="token comment">//å‚æ•°1: æ¶ˆè´¹é‚£ä¸ªé˜Ÿåˆ—çš„æ¶ˆæ¯ é˜Ÿåˆ—åç§°</span>
        <span class="token comment">//å‚æ•°2: å¼€å§‹æ¶ˆæ¯çš„è‡ªåŠ¨ç¡®è®¤æœºåˆ¶</span>
        <span class="token comment">//å‚æ•°3: æ¶ˆè´¹æ—¶çš„å›è°ƒæ¥å£</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token annotation punctuation">@Override</span> <span class="token comment">//æœ€åä¸€ä¸ªå‚æ•°: æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºçš„æ¶ˆæ¯</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> AMQP<span class="token punctuation">.</span><span class="token class-name">BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"===================================="</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>æ§åˆ¶å°è¾“å‡ºå–åˆ°çš„å†…å®¹ï¼š</strong></p>
<pre class="line-numbers language-none"><code class="language-none">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#StaticLoggerBinder for further details.

&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;hello rabbitmq
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/img/Snipaste_2023-07-30_15-37-26.png" loading="lazy"></p>
<p><strong>å¯ä»¥çœ‹å‡ºè¿™ä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å·²è¢«æ¶ˆè´¹â†‘</strong></p>
<p><strong>ä¸ºäº†æ–¹ä¾¿åˆ›å»ºé“¾æ¥å¯¹è±¡ï¼Œå¯ä»¥å†™ä¸€ä¸ªå·¥å…·ç±»ï¼š</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitMQUtils</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ConnectionFactory</span> connectionFactory<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Properties</span> properties<span class="token punctuation">;</span>
    <span class="token keyword">static</span><span class="token punctuation">&#123;</span>
        <span class="token comment">//é‡é‡çº§èµ„æº  ç±»åŠ è½½æ‰§è¡Œä¹‹æ‰§è¡Œä¸€æ¬¡</span>
        connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">"124.71.207.241"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5672</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setVirtualHost</span><span class="token punctuation">(</span><span class="token string">"ems"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"ems"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#125;</span>

    <span class="token comment">//å®šä¹‰æä¾›è¿æ¥å¯¹è±¡çš„æ–¹æ³•</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> connectionFactory<span class="token punctuation">.</span><span class="token function">newConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">//å…³é—­é€šé“å’Œå…³é—­è¿æ¥å·¥å…·æ–¹æ³•</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeConnectionAndChanel</span><span class="token punctuation">(</span><span class="token class-name">Channel</span> channel<span class="token punctuation">,</span> <span class="token class-name">Connection</span> conn<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>channel<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span> channel<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>conn<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span>   conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//System.out.println("RabbitMQUtils.getConnection() = " + RabbitMQUtils.getConnection());</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<hr>
<h3 id="ç¬¬äºŒç§æ¨¡å‹-work-quene"><a href="#ç¬¬äºŒç§æ¨¡å‹-work-quene" class="headerlink" title="ç¬¬äºŒç§æ¨¡å‹(work quene)"></a>ç¬¬äºŒç§æ¨¡å‹(work quene)</h3><p><code>Work queues</code>ï¼Œä¹Ÿè¢«ç§°ä¸ºï¼ˆ<code>Task queues</code>ï¼‰ï¼Œä»»åŠ¡æ¨¡å‹ã€‚å½“æ¶ˆæ¯å¤„ç†æ¯”è¾ƒè€—æ—¶çš„æ—¶å€™ï¼Œå¯èƒ½ç”Ÿäº§æ¶ˆæ¯çš„é€Ÿåº¦ä¼šè¿œè¿œå¤§äºæ¶ˆæ¯çš„æ¶ˆè´¹é€Ÿåº¦ã€‚é•¿æ­¤ä»¥å¾€ï¼Œæ¶ˆæ¯å°±ä¼šå †ç§¯è¶Šæ¥è¶Šå¤šï¼Œæ— æ³•åŠæ—¶å¤„ç†ã€‚æ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨work æ¨¡å‹ï¼š<strong>è®©å¤šä¸ªæ¶ˆè´¹è€…ç»‘å®šåˆ°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå…±åŒæ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯</strong>ã€‚é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ä¸€æ—¦æ¶ˆè´¹ï¼Œå°±ä¼šæ¶ˆå¤±ï¼Œå› æ­¤ä»»åŠ¡æ˜¯ä¸ä¼šè¢«é‡å¤æ‰§è¡Œçš„ã€‚</p>
<p><img src="/img/image-20200314221002008.png" alt="image-20200314221002008" loading="lazy"></p>
<p>è§’è‰²ï¼š</p>
<ul>
<li>Pï¼šç”Ÿäº§è€…ï¼šä»»åŠ¡çš„å‘å¸ƒè€…</li>
<li>C1ï¼šæ¶ˆè´¹è€…-1ï¼Œé¢†å–ä»»åŠ¡å¹¶ä¸”å®Œæˆä»»åŠ¡ï¼Œå‡è®¾å®Œæˆé€Ÿåº¦è¾ƒæ…¢</li>
<li>C2ï¼šæ¶ˆè´¹è€…-2ï¼šé¢†å–ä»»åŠ¡å¹¶å®Œæˆä»»åŠ¡ï¼Œå‡è®¾å®Œæˆé€Ÿåº¦å¿«</li>
</ul>
<h5 id="1-å¼€å‘ç”Ÿäº§è€…-1"><a href="#1-å¼€å‘ç”Ÿäº§è€…-1" class="headerlink" title="1. å¼€å‘ç”Ÿäº§è€…"></a>1. å¼€å‘ç”Ÿäº§è€…</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Provider</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è·å–è¿æ¥å¯¹è±¡</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è·å–é€šé“å¯¹è±¡</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é€šè¿‡é€šé“å£°æ˜é˜Ÿåˆ—</span>
        channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span><span class="token number">20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">//ç”Ÿäº§æ¶ˆæ¯</span>
            channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"work"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">"hello work quene"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">//å…³é—­èµ„æº</span>
        <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">closeConnectionAndChanel</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="2-å¼€å‘æ¶ˆè´¹è€…-1"><a href="#2-å¼€å‘æ¶ˆè´¹è€…-1" class="headerlink" title="2.å¼€å‘æ¶ˆè´¹è€…-1"></a>2.å¼€å‘æ¶ˆè´¹è€…-1</h5><p>æ¶ˆè´¹çš„æ…¢</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer1</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>

        <span class="token comment">//è·å–è¿æ¥</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//channel.basicQos(1);//æ¯ä¸€æ¬¡åªèƒ½æ¶ˆè´¹ä¸€ä¸ªæ¶ˆæ¯</span>
        channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å‚æ•°1:é˜Ÿåˆ—åç§°  å‚æ•°2:æ¶ˆæ¯è‡ªåŠ¨ç¡®è®¤ true  æ¶ˆè´¹è€…è‡ªåŠ¨å‘rabbitmqç¡®è®¤æ¶ˆæ¯æ¶ˆè´¹  false ä¸ä¼šè‡ªåŠ¨ç¡®è®¤æ¶ˆæ¯</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> AMQP<span class="token punctuation">.</span><span class="token class-name">BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">try</span><span class="token punctuation">&#123;</span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆè´¹è€…-1: "</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// å‚æ•°1:ç¡®è®¤é˜Ÿåˆ—ä¸­é‚£ä¸ªå…·ä½“æ¶ˆæ¯ å‚æ•°2:æ˜¯å¦å¼€å¯å¤šä¸ªæ¶ˆæ¯åŒæ—¶ç¡®å®</span>
                <span class="token comment">//channel.basicAck(envelope.getDeliveryTag(),false);</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="3-å¼€å‘æ¶ˆè´¹è€…-2"><a href="#3-å¼€å‘æ¶ˆè´¹è€…-2" class="headerlink" title="3.å¼€å‘æ¶ˆè´¹è€…-2"></a>3.å¼€å‘æ¶ˆè´¹è€…-2</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer2</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>

        <span class="token comment">//è·å–è¿æ¥</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> AMQP<span class="token punctuation">.</span><span class="token class-name">BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆè´¹è€…-2: "</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//æ‰‹åŠ¨ç¡®è®¤  å‚æ•°1:æ‰‹åŠ¨ç¡®è®¤æ¶ˆæ¯æ ‡è¯†  å‚æ•°2:false æ¯æ¬¡ç¡®è®¤ä¸€ä¸ª</span>
                <span class="token comment">//channel.basicAck(envelope.getDeliveryTag(), false);</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        

    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="4-æµ‹è¯•ç»“æœ"><a href="#4-æµ‹è¯•ç»“æœ" class="headerlink" title="4.æµ‹è¯•ç»“æœ"></a>4.æµ‹è¯•ç»“æœ</h5><p><strong>å…ˆå¯åŠ¨ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼Œåœ¨å¯åŠ¨ç”Ÿäº§è€…</strong></p>
<p>Customer1:</p>
<pre class="line-numbers language-none"><code class="language-none">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#StaticLoggerBinder for further details.
æ¶ˆè´¹è€…-1: 2hello work quene
æ¶ˆè´¹è€…-1: 4hello work quene
æ¶ˆè´¹è€…-1: 6hello work quene
æ¶ˆè´¹è€…-1: 8hello work quene
æ¶ˆè´¹è€…-1: 10hello work quene
æ¶ˆè´¹è€…-1: 12hello work quene
æ¶ˆè´¹è€…-1: 14hello work quene
æ¶ˆè´¹è€…-1: 16hello work quene
æ¶ˆè´¹è€…-1: 18hello work quene
æ¶ˆè´¹è€…-1: 20hello work quene<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Customer2:</p>
<pre class="line-numbers language-none"><code class="language-none">æ¶ˆè´¹è€…-2: 1hello work quene
æ¶ˆè´¹è€…-2: 3hello work quene
æ¶ˆè´¹è€…-2: 5hello work quene
æ¶ˆè´¹è€…-2: 7hello work quene
æ¶ˆè´¹è€…-2: 9hello work quene
æ¶ˆè´¹è€…-2: 11hello work quene
æ¶ˆè´¹è€…-2: 13hello work quene
æ¶ˆè´¹è€…-2: 15hello work quene
æ¶ˆè´¹è€…-2: 17hello work quene
æ¶ˆè´¹è€…-2: 19hello work quene<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä»ç®¡ç†ç•Œé¢å¯ä»¥çœ‹å‡ºæ‰€æœ‰æ¶ˆæ¯å·²ç»è¢«æ¶ˆè´¹è°ƒï¼š</p>
<table>
<thead>
<tr>
<th align="left">Overview</th>
<th align="left">Messages</th>
<th align="left">Message rates</th>
<th align="left">+/-</th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left">Virtual host</td>
<td align="left">Name</td>
<td align="left">Features</td>
<td align="left">State</td>
<td align="left">Ready</td>
<td align="left">Unacked</td>
<td align="left">Total</td>
<td align="left">incoming</td>
<td align="left">deliver / get</td>
<td align="left">ack</td>
</tr>
<tr>
<td align="left">ems</td>
<td align="left"><a target="_blank" rel="noopener" href="http://124.71.207.241:15672/#/queues/ems/work">work</a></td>
<td align="left">D</td>
<td align="left">idle</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left"></td>
<td align="left">0.00/s</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<blockquote>
<p><code>æ€»ç»“:é»˜è®¤æƒ…å†µä¸‹ï¼ŒRabbitMQå°†æŒ‰é¡ºåºå°†æ¯ä¸ªæ¶ˆæ¯å‘é€ç»™ä¸‹ä¸€ä¸ªä½¿ç”¨è€…ã€‚å¹³å‡è€Œè¨€ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…éƒ½ä¼šæ”¶åˆ°ç›¸åŒæ•°é‡çš„æ¶ˆæ¯ã€‚è¿™ç§åˆ†å‘æ¶ˆæ¯çš„æ–¹å¼ç§°ä¸ºå¾ªç¯ã€‚</code></p>
</blockquote>
<h5 id="5-æ¶ˆæ¯è‡ªåŠ¨ç¡®è®¤æœºåˆ¶"><a href="#5-æ¶ˆæ¯è‡ªåŠ¨ç¡®è®¤æœºåˆ¶" class="headerlink" title="5.æ¶ˆæ¯è‡ªåŠ¨ç¡®è®¤æœºåˆ¶"></a>5.æ¶ˆæ¯è‡ªåŠ¨ç¡®è®¤æœºåˆ¶</h5><blockquote>
<p>Doing a task can take a few seconds. You may wonder what happens if one of the consumers starts a long task and dies with it only partly done. With our current code, once RabbitMQ delivers a message to the consumer it immediately marks it for deletion. In this case, if you kill a worker we will lose the message it was just processing. Weâ€™ll also lose all the messages that were dispatched to this particular worker but were not yet handled.</p>
<p>But we donâ€™t want to lose any tasks. If a worker dies, weâ€™d like the task to be delivered to another worker.</p>
<p>å®Œæˆä¸€é¡¹ä»»åŠ¡å¯èƒ½éœ€è¦å‡ ç§’é’Ÿã€‚æ‚¨å¯èƒ½æƒ³çŸ¥é“ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªæ¶ˆè´¹è€…å¯åŠ¨äº†ä¸€ä¸ªé•¿ä»»åŠ¡ï¼Œå¹¶ä¸”åªå®Œæˆäº†ä¸€éƒ¨åˆ†å°±ç»“æŸäº†ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆã€‚åœ¨æˆ‘ä»¬å½“å‰çš„ä»£ç ä¸­ï¼Œä¸€æ—¦RabbitMQå°†æ¶ˆæ¯ä¼ é€’ç»™æ¶ˆè´¹è€…ï¼Œå®ƒä¼šç«‹å³å°†å…¶æ ‡è®°ä¸ºåˆ é™¤ï¼ˆè‡ªåŠ¨ç¡®è®¤ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ€æ­»ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œæˆ‘ä»¬å°†ä¸¢å¤±å®ƒæ­£åœ¨å¤„ç†çš„æ¶ˆæ¯ã€‚æˆ‘ä»¬è¿˜ä¼šä¸¢å¤±æ‰€æœ‰å‘é€ç»™è¿™ä¸ªç‰¹å®šæ¶ˆè´¹è€…ä½†å°šæœªå¤„ç†çš„æ¶ˆæ¯ã€‚</p>
</blockquote>
<p>å¦‚æœå…³é—­æ¶ˆè´¹è€…çš„æ¶ˆæ¯è‡ªåŠ¨ç¡®è®¤æœºåˆ¶ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//å‚æ•°1:é˜Ÿåˆ—åç§°  å‚æ•°2:æ¶ˆæ¯è‡ªåŠ¨ç¡®è®¤ true  æ¶ˆè´¹è€…è‡ªåŠ¨å‘rabbitmqç¡®è®¤æ¶ˆæ¯æ¶ˆè´¹  false ä¸ä¼šè‡ªåŠ¨ç¡®è®¤æ¶ˆæ¯</span>
  channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>é‡æ–°æ‰§è¡Œæ¶ˆè´¹è€…å’Œç”Ÿäº§è€…ï¼šå½“æ¶ˆè´¹è€…æ¶ˆè´¹å®Œï¼Œæ¶ˆæ¯è¿˜åœ¨</p>
<table>
<thead>
<tr>
<th align="left">Overview</th>
<th align="left">Messages</th>
<th align="left">Message rates</th>
<th align="left">+/-</th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left">Virtual host</td>
<td align="left">Name</td>
<td align="left">Features</td>
<td align="left">State</td>
<td align="left">Ready</td>
<td align="left">Unacked</td>
<td align="left">Total</td>
<td align="left">incoming</td>
<td align="left">deliver / get</td>
<td align="left">ack</td>
</tr>
<tr>
<td align="left">ems</td>
<td align="left"><a target="_blank" rel="noopener" href="http://124.71.207.241:15672/#/queues/ems/work">work</a></td>
<td align="left">D</td>
<td align="left">idle</td>
<td align="left">20</td>
<td align="left">0</td>
<td align="left">20</td>
<td align="left">0.00/s</td>
<td align="left">0.00/s</td>
<td align="left">0.00/s</td>
</tr>
</tbody></table>
<p>åœ¨å…³é—­è‡ªåŠ¨ç¡®è®¤åï¼Œå¼€å¯æ¶ˆè´¹è€…æ‰‹åŠ¨ç¡®è®¤ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token comment">// å‚æ•°1:ç¡®è®¤é˜Ÿåˆ—ä¸­é‚£ä¸ªå…·ä½“æ¶ˆæ¯ å‚æ•°2:æ˜¯å¦å¼€å¯å¤šä¸ªæ¶ˆæ¯åŒæ—¶ç¡®å®</span>
channel<span class="token punctuation">.</span><span class="token function">basicAck</span><span class="token punctuation">(</span>envelope<span class="token punctuation">.</span><span class="token function">getDeliveryTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>åœ¨æ‰§è¡Œä¸€æ¬¡ï¼šé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯è¢«ç¡®è®¤äº†</p>
<table>
<thead>
<tr>
<th align="left">Overview</th>
<th align="left">Messages</th>
<th align="left">Message rates</th>
<th align="left">+/-</th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left">Virtual host</td>
<td align="left">Name</td>
<td align="left">Features</td>
<td align="left">State</td>
<td align="left">Ready</td>
<td align="left">Unacked</td>
<td align="left">Total</td>
<td align="left">incoming</td>
<td align="left">deliver / get</td>
<td align="left">ack</td>
</tr>
<tr>
<td align="left">ems</td>
<td align="left"><a target="_blank" rel="noopener" href="http://124.71.207.241:15672/#/queues/ems/work">work</a></td>
<td align="left">D</td>
<td align="left">idle</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0.00/s</td>
<td align="left">0.00/s</td>
<td align="left">0.00/s</td>
</tr>
</tbody></table>
<hr>
<p>ä¸ºäº†ä½“ç°èƒ½è€…å¤šåŠ³ï¼ˆæ¶ˆè´¹çš„æ…¢çš„æ¶ˆè´¹è€…è®©å®ƒå°‘æ¶ˆè´¹å‡ ä¸ªï¼‰ï¼Œå¯ä»¥åœ¨æ¶ˆè´¹è€…è®¾ç½®æ¯æ¬¡æ¶ˆè´¹çš„ä¸ªæ•°ï¼š</p>
<p>å¦‚ï¼šä¸Šè¿° â€œå¼€å‘æ¶ˆè´¹è€…-1â€æ¯ä¸¤ç§’æ¶ˆè´¹ä¸€ä¸ªï¼Œå¤ªæ…¢äº†ï¼Œè®©ä»–ä¸€æ¬¡åªèƒ½æ¶ˆè´¹ä¸€ä¸ª</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">channel<span class="token punctuation">.</span><span class="token function">basicQos</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ¯ä¸€æ¬¡åªèƒ½æ¶ˆè´¹ä¸€ä¸ªæ¶ˆæ¯</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>é‡æ–°æ‰§è¡Œï¼šæ¶ˆè´¹è€…1åªæ¶ˆè´¹äº†ä¸€ä¸ª</p>
<p>Customer1:</p>
<pre class="line-numbers language-none"><code class="language-none">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#StaticLoggerBinder for further details.

æ¶ˆè´¹è€…-1: 1hello work quene<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Customer2:</p>
<pre class="line-numbers language-none"><code class="language-none">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#StaticLoggerBinder for further details.

æ¶ˆè´¹è€…-2: 2hello work quene
æ¶ˆè´¹è€…-2: 3hello work quene
æ¶ˆè´¹è€…-2: 4hello work quene
æ¶ˆè´¹è€…-2: 5hello work quene
æ¶ˆè´¹è€…-2: 6hello work quene
æ¶ˆè´¹è€…-2: 7hello work quene
æ¶ˆè´¹è€…-2: 8hello work quene
æ¶ˆè´¹è€…-2: 9hello work quene
æ¶ˆè´¹è€…-2: 10hello work quene
æ¶ˆè´¹è€…-2: 11hello work quene
æ¶ˆè´¹è€…-2: 12hello work quene
æ¶ˆè´¹è€…-2: 13hello work quene
æ¶ˆè´¹è€…-2: 14hello work quene
æ¶ˆè´¹è€…-2: 15hello work quene
æ¶ˆè´¹è€…-2: 16hello work quene
æ¶ˆè´¹è€…-2: 17hello work quene
æ¶ˆè´¹è€…-2: 18hello work quene
æ¶ˆè´¹è€…-2: 19hello work quene
æ¶ˆè´¹è€…-2: 20hello work quene
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>




<h3 id="ç¬¬ä¸‰ç§æ¨¡å‹-fanout"><a href="#ç¬¬ä¸‰ç§æ¨¡å‹-fanout" class="headerlink" title="ç¬¬ä¸‰ç§æ¨¡å‹(fanout)"></a>ç¬¬ä¸‰ç§æ¨¡å‹(fanout)</h3><p><code>fanout æ‰‡å‡º ä¹Ÿç§°ä¸ºå¹¿æ’­</code></p>
<p> <img src="/img/image-20191126213115873.png" alt="image-20191126213115873" loading="lazy"></p>
<p>åœ¨å¹¿æ’­æ¨¡å¼ä¸‹ï¼Œæ¶ˆæ¯å‘é€æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li> å¯ä»¥æœ‰å¤šä¸ªæ¶ˆè´¹è€…</li>
<li> æ¯ä¸ª<strong>æ¶ˆè´¹è€…æœ‰è‡ªå·±çš„queue</strong>ï¼ˆé˜Ÿåˆ—ï¼‰</li>
<li> æ¯ä¸ª<strong>é˜Ÿåˆ—éƒ½è¦ç»‘å®šåˆ°Exchange</strong>ï¼ˆäº¤æ¢æœºï¼‰</li>
<li> <strong>ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ï¼Œåªèƒ½å‘é€åˆ°äº¤æ¢æœº</strong>ï¼Œäº¤æ¢æœºæ¥å†³å®šè¦å‘ç»™å“ªä¸ªé˜Ÿåˆ—ï¼Œç”Ÿäº§è€…æ— æ³•å†³å®šã€‚</li>
<li> äº¤æ¢æœºæŠŠæ¶ˆæ¯å‘é€ç»™ç»‘å®šè¿‡çš„æ‰€æœ‰é˜Ÿåˆ—</li>
<li> é˜Ÿåˆ—çš„æ¶ˆè´¹è€…éƒ½èƒ½æ‹¿åˆ°æ¶ˆæ¯ã€‚å®ç°ä¸€æ¡æ¶ˆæ¯è¢«å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</li>
</ul>
<h5 id="1-å¼€å‘ç”Ÿäº§è€…-2"><a href="#1-å¼€å‘ç”Ÿäº§è€…-2" class="headerlink" title="1. å¼€å‘ç”Ÿäº§è€…"></a>1. å¼€å‘ç”Ÿäº§è€…</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Provider</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è·å–è¿æ¥å¯¹è±¡</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å°†é€šé“å£°æ˜æŒ‡å®šäº¤æ¢æœº   //å‚æ•°1: äº¤æ¢æœºåç§°    å‚æ•°2: äº¤æ¢æœºç±»å‹  fanout å¹¿æ’­ç±»å‹</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">"logs"</span><span class="token punctuation">,</span><span class="token string">"fanout"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å‘é€æ¶ˆæ¯</span>
        <span class="token comment">//å‚æ•°1: äº¤æ¢æœºåç§° å‚æ•°2:é˜Ÿåˆ—åç§°ï¼ˆæ­¤å¤„ä¸ç”¨å£°æ˜ï¼‰  å‚æ•°3:ä¼ é€’æ¶ˆæ¯é¢å¤–è®¾ç½®  å‚æ•°4:æ¶ˆæ¯çš„å…·ä½“å†…å®¹</span>
        channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">"logs"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token string">"fanout type message"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é‡Šæ”¾èµ„æº</span>
        <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">closeConnectionAndChanel</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h5 id="2-å¼€å‘æ¶ˆè´¹è€…-1-1"><a href="#2-å¼€å‘æ¶ˆè´¹è€…-1-1" class="headerlink" title="2. å¼€å‘æ¶ˆè´¹è€…-1"></a>2. å¼€å‘æ¶ˆè´¹è€…-1</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer1</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è·å–è¿æ¥å¯¹è±¡</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é€šé“ç»‘å®šäº¤æ¢æœº</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">"logs"</span><span class="token punctuation">,</span><span class="token string">"fanout"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ä¸´æ—¶é˜Ÿåˆ—</span>
        <span class="token class-name">String</span> queueName <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ç»‘å®šäº¤æ¢æœºå’Œé˜Ÿåˆ—</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span><span class="token string">"logs"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ¶ˆè´¹æ¶ˆæ¯</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> AMQP<span class="token punctuation">.</span><span class="token class-name">BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆè´¹è€…1: "</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="3-å¼€å‘æ¶ˆè´¹è€…-2-1"><a href="#3-å¼€å‘æ¶ˆè´¹è€…-2-1" class="headerlink" title="3. å¼€å‘æ¶ˆè´¹è€…-2"></a>3. å¼€å‘æ¶ˆè´¹è€…-2</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer2</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è·å–è¿æ¥å¯¹è±¡</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é€šé“ç»‘å®šäº¤æ¢æœº</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">"logs"</span><span class="token punctuation">,</span><span class="token string">"fanout"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ä¸´æ—¶é˜Ÿåˆ—</span>
        <span class="token class-name">String</span> queueName <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ç»‘å®šäº¤æ¢æœºå’Œé˜Ÿåˆ—</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span><span class="token string">"logs"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ¶ˆè´¹æ¶ˆæ¯</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> AMQP<span class="token punctuation">.</span><span class="token class-name">BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆè´¹è€…2: "</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="4-å¼€å‘æ¶ˆè´¹è€…-3"><a href="#4-å¼€å‘æ¶ˆè´¹è€…-3" class="headerlink" title="4.å¼€å‘æ¶ˆè´¹è€…-3"></a>4.å¼€å‘æ¶ˆè´¹è€…-3</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer3</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è·å–è¿æ¥å¯¹è±¡</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é€šé“ç»‘å®šäº¤æ¢æœº</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">"logs"</span><span class="token punctuation">,</span><span class="token string">"fanout"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ä¸´æ—¶é˜Ÿåˆ—</span>
        <span class="token class-name">String</span> queueName <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ç»‘å®šäº¤æ¢æœºå’Œé˜Ÿåˆ—</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span><span class="token string">"logs"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ¶ˆè´¹æ¶ˆæ¯</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> AMQP<span class="token punctuation">.</span><span class="token class-name">BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆè´¹è€…3: "</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="5-æµ‹è¯•ç»“æœ"><a href="#5-æµ‹è¯•ç»“æœ" class="headerlink" title="5. æµ‹è¯•ç»“æœ"></a>5. æµ‹è¯•ç»“æœ</h5><p>å…ˆå¯åŠ¨æ¶ˆè´¹è€…ï¼Œåœ¨å¯åŠ¨ç”Ÿäº§è€…</p>
<p>å¯ä»¥åœ¨webç®¡ç†ç•Œé¢æŸ¥çœ‹äº¤æ¢æœº</p>
<p><img src="/img/Snipaste_2023-08-12_16-12-36.png" loading="lazy"></p>
<p> Customer1ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#StaticLoggerBinder for further details.

æ¶ˆè´¹è€…1: fanout type message
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p> Customer2ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#StaticLoggerBinder for further details.

æ¶ˆè´¹è€…2: fanout type message<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Customer3ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#StaticLoggerBinder for further details.

æ¶ˆè´¹è€…3: fanout type message<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<hr>
<h3 id="ç¬¬å››ç§æ¨¡å‹-Routing"><a href="#ç¬¬å››ç§æ¨¡å‹-Routing" class="headerlink" title="ç¬¬å››ç§æ¨¡å‹(Routing)"></a>ç¬¬å››ç§æ¨¡å‹(Routing)</h3><h4 id="Routing-ä¹‹è®¢é˜…æ¨¡å‹-Direct-ç›´è¿"><a href="#Routing-ä¹‹è®¢é˜…æ¨¡å‹-Direct-ç›´è¿" class="headerlink" title="Routing ä¹‹è®¢é˜…æ¨¡å‹-Direct(ç›´è¿)"></a>Routing ä¹‹è®¢é˜…æ¨¡å‹-Direct(ç›´è¿)</h4><p><code>åœ¨Fanoutæ¨¡å¼ä¸­ï¼Œä¸€æ¡æ¶ˆæ¯ï¼Œä¼šè¢«æ‰€æœ‰è®¢é˜…çš„é˜Ÿåˆ—éƒ½æ¶ˆè´¹ã€‚ä½†æ˜¯ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸åŒçš„æ¶ˆæ¯è¢«ä¸åŒçš„é˜Ÿåˆ—æ¶ˆè´¹ã€‚è¿™æ—¶å°±è¦ç”¨åˆ°Directç±»å‹çš„Exchangeã€‚</code></p>
<p> åœ¨Directæ¨¡å‹ä¸‹ï¼š</p>
<ul>
<li>é˜Ÿåˆ—ä¸äº¤æ¢æœºçš„ç»‘å®šï¼Œä¸èƒ½æ˜¯ä»»æ„ç»‘å®šäº†ï¼Œè€Œæ˜¯è¦æŒ‡å®šä¸€ä¸ª<code>RoutingKey</code>ï¼ˆè·¯ç”±keyï¼‰</li>
<li>æ¶ˆæ¯çš„å‘é€æ–¹åœ¨ å‘ Exchangeå‘é€æ¶ˆæ¯æ—¶ï¼Œä¹Ÿå¿…é¡»æŒ‡å®šæ¶ˆæ¯çš„ <code>RoutingKey</code>ã€‚</li>
<li><strong>Exchangeä¸å†æŠŠæ¶ˆæ¯äº¤ç»™æ¯ä¸€ä¸ªç»‘å®šçš„é˜Ÿåˆ—ï¼Œè€Œæ˜¯æ ¹æ®æ¶ˆæ¯çš„<code>Routing Key</code>è¿›è¡Œåˆ¤æ–­ï¼Œåªæœ‰é˜Ÿåˆ—çš„<code>Routingkey</code>ä¸æ¶ˆæ¯çš„ <code>Routing key</code>å®Œå…¨ä¸€è‡´ï¼Œæ‰ä¼šæ¥æ”¶åˆ°æ¶ˆæ¯</strong></li>
</ul>
<p>æµç¨‹:</p>
<p><img src="/img/image-20191126220145375.png" alt="image-20191126220145375" loading="lazy"></p>
<p>å›¾è§£ï¼š</p>
<ul>
<li>Pï¼šç”Ÿäº§è€…ï¼Œå‘Exchangeå‘é€æ¶ˆæ¯ï¼Œå‘é€æ¶ˆæ¯æ—¶ï¼Œä¼šæŒ‡å®šä¸€ä¸ªrouting keyã€‚</li>
<li>Xï¼šExchangeï¼ˆäº¤æ¢æœºï¼‰ï¼Œæ¥æ”¶ç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œç„¶åæŠŠæ¶ˆæ¯é€’äº¤ç»™ ä¸routing keyå®Œå…¨åŒ¹é…çš„é˜Ÿåˆ—</li>
<li>C1ï¼šæ¶ˆè´¹è€…ï¼Œå…¶æ‰€åœ¨é˜Ÿåˆ—æŒ‡å®šäº†éœ€è¦routing key ä¸º error çš„æ¶ˆæ¯</li>
<li>C2ï¼šæ¶ˆè´¹è€…ï¼Œå…¶æ‰€åœ¨é˜Ÿåˆ—æŒ‡å®šäº†éœ€è¦routing key ä¸º infoã€errorã€warning çš„æ¶ˆæ¯</li>
</ul>
<h5 id="1-å¼€å‘ç”Ÿäº§è€…-3"><a href="#1-å¼€å‘ç”Ÿäº§è€…-3" class="headerlink" title="1. å¼€å‘ç”Ÿäº§è€…"></a>1. å¼€å‘ç”Ÿäº§è€…</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Provider</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è·å–è¿æ¥å¯¹è±¡</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è·å–è¿æ¥é€šé“å¯¹è±¡</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> exchangeName <span class="token operator">=</span> <span class="token string">"logs_direct"</span><span class="token punctuation">;</span>
        <span class="token comment">//é€šè¿‡é€šé“å£°æ˜äº¤æ¢æœº  å‚æ•°1:äº¤æ¢æœºåç§°  å‚æ•°2:direct  è·¯ç”±æ¨¡å¼</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span>exchangeName<span class="token punctuation">,</span><span class="token string">"direct"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å‘é€æ¶ˆæ¯</span>
        <span class="token class-name">String</span> routingkey <span class="token operator">=</span> <span class="token string">"info"</span><span class="token punctuation">;</span>
        channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span>exchangeName<span class="token punctuation">,</span>routingkey<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">"è¿™æ˜¯directæ¨¡å‹å‘å¸ƒçš„åŸºäºroute key: ["</span><span class="token operator">+</span>routingkey<span class="token operator">+</span><span class="token string">"] å‘é€çš„æ¶ˆæ¯"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//å…³é—­èµ„æº</span>
        <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">closeConnectionAndChanel</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="2-å¼€å‘æ¶ˆè´¹è€…-1-2"><a href="#2-å¼€å‘æ¶ˆè´¹è€…-1-2" class="headerlink" title="2.å¼€å‘æ¶ˆè´¹è€…-1"></a>2.å¼€å‘æ¶ˆè´¹è€…-1</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer1</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> exchangeName <span class="token operator">=</span> <span class="token string">"logs_direct"</span><span class="token punctuation">;</span>
        <span class="token comment">//é€šé“å£°æ˜äº¤æ¢æœºä»¥åŠäº¤æ¢çš„ç±»å‹</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span>exchangeName<span class="token punctuation">,</span><span class="token string">"direct"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ›å»ºä¸€ä¸ªä¸´æ—¶é˜Ÿåˆ—</span>
        <span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åŸºäºroute keyç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span>exchangeName<span class="token punctuation">,</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è·å–æ¶ˆè´¹çš„æ¶ˆæ¯</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> AMQP<span class="token punctuation">.</span><span class="token class-name">BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆè´¹è€…1: "</span><span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="3-å¼€å‘æ¶ˆè´¹è€…-2-2"><a href="#3-å¼€å‘æ¶ˆè´¹è€…-2-2" class="headerlink" title="3.å¼€å‘æ¶ˆè´¹è€…-2"></a>3.å¼€å‘æ¶ˆè´¹è€…-2</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer2</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> exchangeName <span class="token operator">=</span> <span class="token string">"logs_direct"</span><span class="token punctuation">;</span>
        <span class="token comment">//å£°æ˜äº¤æ¢æœº ä»¥åŠäº¤æ¢æœºç±»å‹ direct</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span>exchangeName<span class="token punctuation">,</span><span class="token string">"direct"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ›å»ºä¸€ä¸ªä¸´æ—¶é˜Ÿåˆ—</span>
        <span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ä¸´æ—¶é˜Ÿåˆ—å’Œäº¤æ¢æœºç»‘å®š</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span>exchangeName<span class="token punctuation">,</span><span class="token string">"info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span>exchangeName<span class="token punctuation">,</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span>exchangeName<span class="token punctuation">,</span><span class="token string">"warning"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ¶ˆè´¹æ¶ˆæ¯</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> AMQP<span class="token punctuation">.</span><span class="token class-name">BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆè´¹è€…2: "</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="4-æµ‹è¯•ç»“æœ-1"><a href="#4-æµ‹è¯•ç»“æœ-1" class="headerlink" title="4.æµ‹è¯•ç»“æœ"></a>4.æµ‹è¯•ç»“æœ</h5><p>å…ˆå¯åŠ¨æ¶ˆè´¹è€…ï¼Œåœ¨å¯åŠ¨ç”Ÿäº§è€…,æµ‹è¯•ç”Ÿäº§è€…å‘é€Route keyä¸ºinfoçš„æ¶ˆæ¯æ—¶</p>
<p> Customer1ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#StaticLoggerBinder for further details.

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p> Customer2ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#StaticLoggerBinder for further details.

æ¶ˆè´¹è€…2: è¿™æ˜¯directæ¨¡å‹å‘å¸ƒçš„åŸºäºroute key: [info] å‘é€çš„æ¶ˆæ¯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¯<strong>ä»¥çœ‹å‡ºå› ä¸º æ¶ˆè´¹è€…2å’Œç”Ÿäº§è€…æœ‰ä¸€æ ·çš„routingkeyï¼Œæ‰€ä»¥æ¶ˆè´¹åˆ°äº†æ¶ˆæ¯</strong></p>
<hr>
<h4 id="Routing-ä¹‹è®¢é˜…æ¨¡å‹-Topic"><a href="#Routing-ä¹‹è®¢é˜…æ¨¡å‹-Topic" class="headerlink" title="Routing ä¹‹è®¢é˜…æ¨¡å‹-Topic"></a>Routing ä¹‹è®¢é˜…æ¨¡å‹-Topic</h4><p><code>Topic</code>ç±»å‹çš„<code>Exchange</code>ä¸<code>Direct</code>ç›¸æ¯”ï¼Œéƒ½æ˜¯å¯ä»¥æ ¹æ®<code>RoutingKey</code>æŠŠæ¶ˆæ¯è·¯ç”±åˆ°ä¸åŒçš„é˜Ÿåˆ—ã€‚åªä¸è¿‡<code>Topic</code>ç±»å‹<code>Exchange</code>å¯ä»¥è®©é˜Ÿåˆ—åœ¨ç»‘å®š<code>Routing key</code> çš„æ—¶å€™ä½¿ç”¨é€šé…ç¬¦ï¼è¿™ç§æ¨¡å‹<code>Routingkey</code> ä¸€èˆ¬éƒ½æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå•è¯ç»„æˆï¼Œå¤šä¸ªå•è¯ä¹‹é—´ä»¥â€.â€åˆ†å‰²ï¼Œä¾‹å¦‚ï¼š <code>item.insert</code></p>
<p><img src="/img/image-20191127121900255.png" alt="image-20191127121900255" loading="lazy"></p>
<pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> ç»Ÿé…ç¬¦</span>
		<span class="token list punctuation">*</span> (star) can substitute for exactly one word.    åŒ¹é…ä¸å¤šä¸å°‘æ°å¥½1ä¸ªè¯
		     å¦‚ï¼šuser.<span class="token italic"><span class="token punctuation">*</span><span class="token content">  == user.save , user.delete ,user.info ç­‰ç­‰
		# (hash) can substitute for zero or more words.  åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªè¯
		     å¦‚ï¼šuser.#  == user.save , user.delete.save ç­‰ç­‰
# å¦‚:
		audit.#    åŒ¹é…audit.irs.corporateæˆ–è€… audit.irs ç­‰
    audit.</span><span class="token punctuation">*</span></span>   åªèƒ½åŒ¹é… audit.irs
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="1-å¼€å‘ç”Ÿäº§è€…-4"><a href="#1-å¼€å‘ç”Ÿäº§è€…-4" class="headerlink" title="1.å¼€å‘ç”Ÿäº§è€…"></a>1.å¼€å‘ç”Ÿäº§è€…</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Provider</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è·å–è¿æ¥å¯¹è±¡</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å£°æ˜äº¤æ¢æœºä»¥åŠäº¤æ¢æœºç±»å‹ topic</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">"topics"</span><span class="token punctuation">,</span><span class="token string">"topic"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å‘å¸ƒæ¶ˆæ¯</span>
        <span class="token class-name">String</span> routekey <span class="token operator">=</span> <span class="token string">"save.user.delete"</span><span class="token punctuation">;</span>
        channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">"topics"</span><span class="token punctuation">,</span>routekey<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">"è¿™é‡Œæ˜¯topicåŠ¨æ€è·¯ç”±æ¨¡å‹,routekey: ["</span><span class="token operator">+</span>routekey<span class="token operator">+</span><span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å…³é—­èµ„æº</span>
        <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">closeConnectionAndChanel</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="2-å¼€å‘æ¶ˆè´¹è€…-1-3"><a href="#2-å¼€å‘æ¶ˆè´¹è€…-1-3" class="headerlink" title="2.å¼€å‘æ¶ˆè´¹è€…-1"></a>2.å¼€å‘æ¶ˆè´¹è€…-1</h5><p><code>Routing Keyä¸­ä½¿ç”¨*é€šé…ç¬¦æ–¹å¼</code></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer1</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è·å–è¿æ¥</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å£°æ˜äº¤æ¢æœºä»¥åŠäº¤æ¢æœºç±»å‹</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">"topics"</span><span class="token punctuation">,</span><span class="token string">"topic"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ›å»ºä¸€ä¸ªä¸´æ—¶é˜Ÿåˆ—</span>
        <span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº  åŠ¨æ€ç»Ÿé…ç¬¦å½¢å¼route key</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token string">"topics"</span><span class="token punctuation">,</span><span class="token string">"*.user.*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ¶ˆè´¹æ¶ˆæ¯</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> AMQP<span class="token punctuation">.</span><span class="token class-name">BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆè´¹è€…1: "</span><span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="3-å¼€å‘æ¶ˆè´¹è€…-2-3"><a href="#3-å¼€å‘æ¶ˆè´¹è€…-2-3" class="headerlink" title="3.å¼€å‘æ¶ˆè´¹è€…-2"></a>3.å¼€å‘æ¶ˆè´¹è€…-2</h5><p><code>Routing Keyä¸­ä½¿ç”¨#é€šé…ç¬¦æ–¹å¼</code></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer2</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è·å–è¿æ¥</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å£°æ˜äº¤æ¢æœºä»¥åŠäº¤æ¢æœºç±»å‹</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">"topics"</span><span class="token punctuation">,</span><span class="token string">"topic"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ›å»ºä¸€ä¸ªä¸´æ—¶é˜Ÿåˆ—</span>
        <span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº  åŠ¨æ€ç»Ÿé…ç¬¦å½¢å¼route key</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token string">"topics"</span><span class="token punctuation">,</span><span class="token string">"*.user.#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ¶ˆè´¹æ¶ˆæ¯</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> AMQP<span class="token punctuation">.</span><span class="token class-name">BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆè´¹è€…2: "</span><span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="4-æµ‹è¯•ç»“æœ-2"><a href="#4-æµ‹è¯•ç»“æœ-2" class="headerlink" title="4.æµ‹è¯•ç»“æœ"></a>4.æµ‹è¯•ç»“æœ</h5><p>å…ˆå¯åŠ¨æ¶ˆè´¹è€…ï¼Œåœ¨å¯åŠ¨ç”Ÿäº§è€…</p>
<p> Customer1ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#StaticLoggerBinder for further details.

æ¶ˆè´¹è€…1: è¿™é‡Œæ˜¯topicåŠ¨æ€è·¯ç”±æ¨¡å‹,routekey: [save.user.delete]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p> Customer2ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#StaticLoggerBinder for further details.

æ¶ˆè´¹è€…2: è¿™é‡Œæ˜¯topicåŠ¨æ€è·¯ç”±æ¨¡å‹,routekey: [save.user.delete]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="Donate" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">ç»™ä¸ªé¥­é’±ï¼Ÿ</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://i.loli.net/2020/12/23/J2Sv6rVeLtAPiHx.jpg"><img loading="lazy" src="https://i.loli.net/2020/12/23/J2Sv6rVeLtAPiHx.jpg" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://i.loli.net/2020/12/23/4rBXF1deMD6KyN8.png"><img loading="lazy" src="https://i.loli.net/2020/12/23/4rBXF1deMD6KyN8.png" alt="QQ æ”¯ä»˜" title="QQ æ”¯ä»˜"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://i.loli.net/2020/12/23/XvirFV3o6GyRMZU.png"><img loading="lazy" src="https://i.loli.net/2020/12/23/XvirFV3o6GyRMZU.png" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>Sovzn</li><li class="post-copyright-link"><strong>Post link: </strong><a href="http://sovzn.github.io/2023/07/29/RabbitMQ/" title="RabbitMQ">http://sovzn.github.io/2023/07/29/RabbitMQ/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless otherwise stated.</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2023/08/12/RabbitMQ%E6%95%B4%E5%90%88SpringBoot/" rel="prev" title="RabbitMQæ•´åˆSpringBoot"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">RabbitMQæ•´åˆSpringBoot</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2022/12/03/collect/" rel="next" title="collect"><span class="post-nav-text">collect</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>ç‚¹å‡»æŒ‰é’®è·³è½¬ GitHub Issues è¯„è®ºã€‚</span><br><span>è‹¥æ²¡æœ‰æœ¬æ–‡ Issueï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Comment æ¨¡ç‰ˆæ–°å»ºã€‚</span><br><a class="hty-button hty-button--raised" id="github-issues" target="_blank" rel="noopener" href="https://github.com/YunYouJun/yunyoujun.github.io/issues?q=is:issue+RabbitMQ">GitHub Issues</a></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 â€“ 2026 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Sovzn</span></div><div class="live_time"><span>æœ¬åšå®¢å·²è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  window.setTimeout(blog_live_time, 1000);
  const start = new Date('2020-04-12T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div id="local-search-result"></div></div></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script></body></html>