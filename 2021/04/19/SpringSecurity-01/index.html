<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="Sovzn"><meta name="copyright" content="Sovzn"><meta name="generator" content="Hexo 5.3.0"><meta name="theme" content="hexo-theme-yun"><title>SpringSecurity_01 | å¤§å¸ˆå…„</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.22/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#6200ee"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"sovzn.github.io","root":"/","title":"å¤§å¸ˆå…„çš„å°ç ´ç«™","version":"1.3.0","mode":"auto","copycode":true,"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><meta name="description" content="Spring Security    Spring Securityç®€ä»‹  Spring Securityæ˜¯ä¸€ä¸ªé«˜åº­è‡ªå®šä¹‰çš„å®‰å…¨æ¡†æ¶ã€‚åˆ©ç”¨Spring loC&#x2F;Dlå’ŒAOPåŠŸèƒ½ï¼Œä¸ºç³»ç»Ÿæä¾›äº†å£°æ˜å¼å®‰å…¨è®¿é—®æ§åˆ¶åŠŸèƒ½ï¼Œå‡å°‘äº†ä¸ºç³»ç»Ÿå®‰å…¨è€Œç¼–å†™å¤§é‡é‡å¤ä»£ç çš„å·¥ä½œã€‚ä½¿ç”¨ Spring Secruityçš„åŸå› æœ‰å¾ˆå¤šï¼Œä½†å¤§éƒ¨åˆ†éƒ½æ˜¯å‘ç°äº†javaEEçš„ Servlet è§„èŒƒæˆ–EJBè§„èŒƒä¸­çš„å®‰å…¨åŠŸèƒ½ç¼ºä¹å…¸å‹ä¼ä¸šåº”ç”¨">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringSecurity_01">
<meta property="og:url" content="http://sovzn.github.io/2021/04/19/SpringSecurity-01/index.html">
<meta property="og:site_name" content="å¤§å¸ˆå…„">
<meta property="og:description" content="Spring Security    Spring Securityç®€ä»‹  Spring Securityæ˜¯ä¸€ä¸ªé«˜åº­è‡ªå®šä¹‰çš„å®‰å…¨æ¡†æ¶ã€‚åˆ©ç”¨Spring loC&#x2F;Dlå’ŒAOPåŠŸèƒ½ï¼Œä¸ºç³»ç»Ÿæä¾›äº†å£°æ˜å¼å®‰å…¨è®¿é—®æ§åˆ¶åŠŸèƒ½ï¼Œå‡å°‘äº†ä¸ºç³»ç»Ÿå®‰å…¨è€Œç¼–å†™å¤§é‡é‡å¤ä»£ç çš„å·¥ä½œã€‚ä½¿ç”¨ Spring Secruityçš„åŸå› æœ‰å¾ˆå¤šï¼Œä½†å¤§éƒ¨åˆ†éƒ½æ˜¯å‘ç°äº†javaEEçš„ Servlet è§„èŒƒæˆ–EJBè§„èŒƒä¸­çš„å®‰å…¨åŠŸèƒ½ç¼ºä¹å…¸å‹ä¼ä¸šåº”ç”¨">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20210419092129244.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTEwMDk0MA==,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20210419102923518.png">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">
<meta property="article:published_time" content="2021-04-19T01:19:14.000Z">
<meta property="article:modified_time" content="2021-05-07T01:37:48.224Z">
<meta property="article:author" content="Sovzn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20210419092129244.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTEwMDk0MA==,size_16,color_FFFFFF,t_70"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Sovzn"><img width="96" loading="lazy" src="/Yun.png" alt="Sovzn"><span class="site-author-status" title="æ°¸è¿œç›¸ä¿¡ç¾å¥½çš„äº‹æƒ…å³å°†å‘ç”Ÿ">ğŸ˜Š</span></a><div class="site-author-name"><a href="/about/">Sovzn</a></div><a class="site-name" href="/about/site.html">å¤§å¸ˆå…„</a><sub class="site-subtitle"></sub><div class="site-desciption">æˆ‘åªæ‹¥æœ‰ä½ çš„æœˆå…‰,æˆ‘è¦æŠŠå®ƒå½“ä½œéª„é˜³ã€‚</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">90</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">30</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">20</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="æ–‡æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="http://wpa.qq.com/msgrd?v=3&amp;uin=&amp;site=qq&amp;menu=yes" title="QQ" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="å¾®åš" target="_blank" style="color:#E6162D"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-weibo-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="è±†ç“£" target="_blank" style="color:#007722"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-douban-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="çŸ¥ä¹" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="å“”å“©å“”å“©" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="Telegram Channel" target="_blank" style="color:#0088CC"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-telegram-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-send-plane-2-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/null" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring-Security"><span class="toc-number">1.</span> <span class="toc-text">Spring Security</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-number">1.1.</span> <span class="toc-text">å¿«é€Ÿå…¥é—¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="toc-number">1.1.1.</span> <span class="toc-text">å¯¼å…¥ä¾èµ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UserDetailsService"><span class="toc-number">1.1.2.</span> <span class="toc-text">UserDetailsService</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PasswordEncoder%E5%AF%86%E7%A0%81%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="toc-number">1.1.3.</span> <span class="toc-text">PasswordEncoderå¯†ç è§£æå™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">æ¥å£ä»‹ç»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95PasswordEncoder"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">æµ‹è¯•PasswordEncoder</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%99%BB%E5%BD%95%E9%80%BB%E8%BE%91"><span class="toc-number">1.1.4.</span> <span class="toc-text">è‡ªå®šä¹‰ç™»å½•é€»è¾‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2"><span class="toc-number">1.1.5.</span> <span class="toc-text">è‡ªå®šä¹‰ç™»å½•é¡µé¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%AF%B7%E6%B1%82%E8%B4%A6%E5%8F%B7%E5%92%8C%E5%AF%86%E7%A0%81%E7%9A%84%E5%8F%82%E6%95%B0%E5%90%8D"><span class="toc-number">1.1.6.</span> <span class="toc-text">è®¾ç½®è¯·æ±‚è´¦å·å’Œå¯†ç çš„å‚æ•°å</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%99%BB%E5%BD%95%E6%88%90%E5%8A%9F-%E5%A4%B1%E8%B4%A5%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-number">1.1.7.</span> <span class="toc-text">è‡ªå®šä¹‰ç™»å½•æˆåŠŸ&#x2F;å¤±è´¥å¤„ç†å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#regexMatchers%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.1.8.</span> <span class="toc-text">regexMatchersè¯¦è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E5%88%A4%E6%96%AD"><span class="toc-number">1.1.9.</span> <span class="toc-text">æƒé™åˆ¤æ–­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#hasAuthority-String"><span class="toc-number">1.1.9.1.</span> <span class="toc-text">hasAuthority (String)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hasAnyAuthority-String-%E2%80%A6"><span class="toc-number">1.1.9.2.</span> <span class="toc-text">hasAnyAuthority(String â€¦)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%92%E8%89%B2%E5%88%A4%E6%96%AD"><span class="toc-number">1.1.10.</span> <span class="toc-text">è§’è‰²åˆ¤æ–­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#hasRole-String"><span class="toc-number">1.1.10.1.</span> <span class="toc-text">hasRole(String)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hasAnyRole-String%E2%80%A6"><span class="toc-number">1.1.10.2.</span> <span class="toc-text">hasAnyRole( Stringâ€¦ )</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.1.10.3.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IP%E5%9C%B0%E5%9D%80%E5%88%A4%E6%96%AD"><span class="toc-number">1.1.11.</span> <span class="toc-text">IPåœ°å€åˆ¤æ–­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89403%E5%A4%84%E7%90%86%E6%96%B9%E6%A1%88"><span class="toc-number">1.1.12.</span> <span class="toc-text">è‡ªå®šä¹‰403å¤„ç†æ–¹æ¡ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E5%AE%9E%E7%8E%B0AccessDeniedHandler"><span class="toc-number">1.1.12.1.</span> <span class="toc-text">ç¬¬ä¸€æ­¥ï¼šå®ç°AccessDeniedHandler</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E9%85%8D%E7%BD%AE"><span class="toc-number">1.1.12.2.</span> <span class="toc-text">ç¬¬äºŒæ­¥ï¼šé…ç½®</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://Sovzn.github.io/2021/04/19/SpringSecurity-01/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Sovzn"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="å¤§å¸ˆå…„"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">SpringSecurity_01</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="Created: 2021-04-19 09:19:14" itemprop="dateCreated datePublished" datetime="2021-04-19T09:19:14+08:00">2021-04-19</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="Modified: 2021-05-07 09:37:48" itemprop="dateModified" datetime="2021-05-07T09:37:48+08:00">2021-05-07</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/Java%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Javaå®‰å…¨æ¡†æ¶</span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/Java%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/SpringSecurity/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">SpringSecurity</span></a></span></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#6200ee;"><h1 id="Spring-Security"><a href="#Spring-Security" class="headerlink" title="Spring Security"></a>Spring Security</h1><p> <img src="https://img-blog.csdnimg.cn/20210419092129244.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTEwMDk0MA==,size_16,color_FFFFFF,t_70" alt="img" loading="lazy"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"> </p>
<blockquote>
<p>Spring Securityç®€ä»‹</p>
</blockquote>
<p>Spring Securityæ˜¯ä¸€ä¸ªé«˜åº­è‡ªå®šä¹‰çš„å®‰å…¨æ¡†æ¶ã€‚åˆ©ç”¨Spring loC/Dlå’ŒAOPåŠŸèƒ½ï¼Œä¸ºç³»ç»Ÿæä¾›äº†å£°æ˜å¼å®‰å…¨è®¿é—®æ§åˆ¶åŠŸèƒ½ï¼Œå‡å°‘äº†ä¸ºç³»ç»Ÿå®‰å…¨è€Œç¼–å†™å¤§é‡é‡å¤ä»£ç çš„å·¥ä½œã€‚ä½¿ç”¨ Spring Secruityçš„åŸå› æœ‰å¾ˆå¤šï¼Œä½†å¤§éƒ¨åˆ†éƒ½æ˜¯å‘ç°äº†javaEEçš„ Servlet è§„èŒƒæˆ–EJBè§„èŒƒä¸­çš„å®‰å…¨åŠŸèƒ½ç¼ºä¹å…¸å‹ä¼ä¸šåº”ç”¨åœºæ™¯ã€‚åŒæ—¶è®¤è¯†åˆ°ä»–ä»¬åœ¨WARæˆ–EARçº§åˆ«æ— æ³•ç§»æ¤ã€‚å› æ­¤å¦‚æœä½ æ›´æ¢æœåŠ¡å™¨ç¯å¢ƒï¼Œè¿˜æœ‰å¤§é‡å·¥ä½œå»é‡æ–°é…ç½®ä½ çš„åº”ç”¨ç¨‹åºã€‚ä½¿ç”¨ Spring Securityè§£å†³äº†è¿™äº›é—®é¢˜ï¼Œä¹Ÿä¸ºä½ æä¾›è®¸å¤šå…¶ä»–æœ‰ç”¨çš„ã€å¯å®šåˆ¶çš„å®‰å…¨åŠŸèƒ½ã€‚æ­£å¦‚ä½ å¯èƒ½çŸ¥é“çš„ä¸¤ä¸ªåº”ç”¨ç¨‹åºçš„ä¸¤ä¸ªä¸»è¦åŒºåŸŸæ˜¯â€œè®¤è¯â€œå’Œâ€œæˆæƒâ€ï¼ˆæˆ–è€…è®¿é—®æ§åˆ¶ï¼‰ã€‚è¿™ä¸¤ç‚¹ä¹Ÿæ˜¯Spring Securityé‡è¦æ ¸å¿ƒåŠŸèƒ½ã€‚â€œè®¤è¯â€ï¼Œæ˜¯å»ºç«‹ä¸€ä¸ªä»–å£°æ˜çš„ä¸»ä½“çš„è¿‡ç¨‹ï¼ˆä¸€ä¸ªâ€œä¸»ä½“â€ä¸€èˆ¬æ˜¯æŒ‡ç”¨æˆ·ï¼Œè®¾å¤‡æˆ–ä¸€äº›å¯ä»¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­æ‰§è¡ŒåŠ¨ä½œçš„å…¶ä»–ç³»ç»Ÿï¼‰ï¼Œé€šä¿—ç‚¹è¯´å°±æ˜¯ç³»ç»Ÿè®¤ä¸ºç”¨æˆ·æ˜¯å¦èƒ½ç™»å½•ã€‚â€œæˆæƒâ€œæŒ‡ç¡®å®šä¸€ä¸ªä¸»ä½“æ˜¯å¦å…è®¸åœ¨ä½ çš„åº”ç”¨ç¨‹åºæ‰§è¡Œä¸€ä¸ªåŠ¨ä½œçš„è¿‡ç¨‹ã€‚é€šä¿—ç‚¹è®²å°±æ˜¯ç³»ç»Ÿåˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰æƒé™å»åšæŸäº›äº‹æƒ…ã€‚</p>
<h2 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h2><h3 id="å¯¼å…¥ä¾èµ–"><a href="#å¯¼å…¥ä¾èµ–" class="headerlink" title="å¯¼å…¥ä¾èµ–"></a>å¯¼å…¥ä¾èµ–</h3><pre class="line-numbers language-XML" data-language="XML"><code class="language-XML">&lt;!-- SpringSecurity ç»„ä»¶--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-security&lt;&#x2F;artifactId&gt;
        &lt;&#x2F;dependency&gt;
        &lt;!--web ç»„ä»¶--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;&#x2F;artifactId&gt;
        &lt;&#x2F;dependency&gt;
        &lt;!---Test ç»„ä»¶--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;&#x2F;artifactId&gt;
            &lt;scope&gt;test&lt;&#x2F;scope&gt;
            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;org.junit.vintage&lt;&#x2F;groupId&gt;
                    &lt;artifactId&gt;junit-vintage-engine&lt;&#x2F;artifactId&gt;
                &lt;&#x2F;exclusion&gt;
            &lt;&#x2F;exclusions&gt;
        &lt;&#x2F;dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.security&lt;&#x2F;groupId&gt;
            &lt;artifactId&gt;spring-security-test&lt;&#x2F;artifactId&gt;
            &lt;scope&gt;test&lt;&#x2F;scope&gt;
        &lt;&#x2F;dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="UserDetailsService"><a href="#UserDetailsService" class="headerlink" title="UserDetailsService"></a>UserDetailsService</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">UserDetails</span> <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> var1<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UsernameNotFoundException</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="PasswordEncoderå¯†ç è§£æå™¨"><a href="#PasswordEncoderå¯†ç è§£æå™¨" class="headerlink" title="PasswordEncoderå¯†ç è§£æå™¨"></a>PasswordEncoderå¯†ç è§£æå™¨</h3><p>Spring Security è¦æ±‚å®¹å™¨ä¸­å¿…é¡»æœ‰<strong>PasswordEncoder</strong>å®ä¾‹ã€‚æ‰€ä»¥å½“è‡ªå®šä¹‰ç™»æ™¯é€»è¾‘æ—¶è¦æ±‚å¿…é¡»ç»™å®¹å™¨æ³¨å…¥<strong>PaswordEncoder</strong> çš„beanå¯¹è±¡ã€‚</p>
<h4 id="æ¥å£ä»‹ç»"><a href="#æ¥å£ä»‹ç»" class="headerlink" title="æ¥å£ä»‹ç»"></a>æ¥å£ä»‹ç»</h4><ul>
<li><font color='red'> encodeï¼ˆï¼‰ </font>ï¼šæŠŠå‚æ•°æŒ‰ç…§ç‰¹å®šçš„è§£æè§„åˆ™è¿›è¡Œè§£æ</li>
<li><font color='red'>matchesï¼ˆï¼‰</font>ï¼šéªŒè¯ä»å­˜å‚¨ä¸­è·å–çš„ç¼–ç å¯†ç ä¸ç¼–ç åæäº¤çš„<font color='cornflowerblue'>åŸå§‹å¯†ç </font>æ˜¯å¦åŒ¹é…ï¼Œåˆ™è¿”å› <strong>true</strong>ï¼Œå¦‚æœä¸åŒ¹é…ï¼Œåˆ™è¿”å› <strong>false</strong>ã€‚ç¬¬ä¸€å‚æ•°è¡¨ç¤ºè¢«è§£æçš„å¯†ç ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºå­˜å‚¨çš„å¯†ç ã€‚</li>
<li><font color='red'>upgradeEncoding ( )</font> :å¦‚æœè§£æçš„å¯†ç èƒ½å¤Ÿå†æ¬¡è§£æä¸”è¾¾åˆ°æ›´å®‰å…¨çš„ç»“æœï¼Œåˆ™è¿”å› <strong>true</strong>ï¼Œå¦åˆ™è¿”å› <strong>false</strong>ï¼Œé»˜è®¤è¿”å› <strong>false</strong>ã€‚</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20210419102923518.png" alt="img" loading="lazy"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"> </p>
<h4 id="æµ‹è¯•PasswordEncoder"><a href="#æµ‹è¯•PasswordEncoder" class="headerlink" title="æµ‹è¯•PasswordEncoder"></a>æµ‹è¯•PasswordEncoder</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">SpringsecurityDemoApplicationTests</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token class-name">TestPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//æ¨èä½¿ç”¨BCryptPasswordEncoder()æ¥å®ç°</span>
        <span class="token class-name">PasswordEncoder</span> pw<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åŠ å¯†æ˜æ–‡å¯†ç </span>
        <span class="token class-name">String</span> encode<span class="token operator">=</span>pw<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>encode<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">boolean</span> matches<span class="token operator">=</span>pw<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">,</span>encode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>matches<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

ç»“æœï¼š
<span class="token comment">//1.</span>
$<span class="token number">2</span>a$<span class="token number">10</span>$<span class="token class-name">OuUV2MMtAHbrLggli5v9NuNWUJN</span><span class="token operator">/</span>ta<span class="token punctuation">.</span>xonKHQQc0B<span class="token punctuation">.</span><span class="token class-name">NON0y3RpPF2</span>
<span class="token boolean">true</span>
<span class="token comment">//2.</span>
$<span class="token number">2</span>a$<span class="token number">10</span>$<span class="token number">7</span>IYwRo639Rb4MeN5hgS5Hu<span class="token punctuation">.</span>eRxxfr<span class="token operator">/</span>qPxq0f5BFSg<span class="token punctuation">.</span><span class="token class-name">NR7j</span><span class="token operator">/</span><span class="token class-name">Y3lXjq</span>
<span class="token boolean">true</span>
    
 <span class="token comment">//å¯ä»¥å‘ç°ï¼Œæ¯æ¬¡ç”Ÿæˆçš„å¯†æ–‡éƒ½ä¸ä¸€æ ·ï¼Œå› ä¸ºåœ¨BCryptPasswordEncoder();æ¯æ¬¡éƒ½ä¼šç”Ÿæˆæ–°çš„ç›  </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="è‡ªå®šä¹‰ç™»å½•é€»è¾‘"><a href="#è‡ªå®šä¹‰ç™»å½•é€»è¾‘" class="headerlink" title="è‡ªå®šä¹‰ç™»å½•é€»è¾‘"></a>è‡ªå®šä¹‰ç™»å½•é€»è¾‘</h3><p><strong>SpringSecurityé…ç½®ç±»ï¼š</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/*
* Spring Securityçš„é…ç½®ç±»
* */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//å°†PasswordEncoderæ³¨å…¥å®¹å™¨ï¼Œæ–¹ä¾¿ä½¿ç”¨</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">PasswordEncoder</span> <span class="token function">getPw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token comment">//è¿”å›ä¸€ä¸ªPasswordEncoderå®ä¾‹</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>UserDetailsServiceçš„å®ç°ç±»</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/*
* UserDetailsServiceçš„å®ç°ç±»
* */</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDetailsServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">PasswordEncoder</span> pw<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">UserDetails</span> <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UsernameNotFoundException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//1.æŸ¥è¯¢ä¼ è¿›æ¥åˆ°çš„ç”¨æˆ·åï¼ˆusernameï¼‰åœ¨æ•°æ®åº“ä¸­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±æŠ›å‡ºå¼‚å¸¸ï¼šUsernameNotFoundException</span>
        <span class="token comment">//ä¸‹é¢å…ˆä½¿ç”¨å‡æ•°æ®ï¼š</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">"admin"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UsernameNotFoundException</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·åä¸å­˜åœ¨"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//2.å¦‚æœç”¨æˆ·åå­˜åœ¨ï¼ŒæŠŠæŸ¥è¯¢å‡ºæ¥çš„å¯†ç ï¼ˆæ³¨å†Œæ—¶å·²ç»åŠ å¯†è¿‡çš„ï¼‰è¿›è¡Œè§£æï¼Œæˆ–è€…ç›´æ¥æŠŠå¯†ç æ”¾å…¥æ„é€ æ–¹æ³•ï¼Œä¸‹é¢ä¹Ÿä½¿ç”¨å‡æ•°æ®</span>
        <span class="token comment">//ä¸‹é¢è¿™ä¸ªUseræ˜¯SpringSecurityä¸­çš„Userï¼Œç±»ä¼¼äºShiroä¸­çš„Subject</span>
        <span class="token class-name">String</span> password<span class="token operator">=</span>pw<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">// Useræ„é€ æ–¹æ³•çš„å‚æ•°ï¼š</span>
        <span class="token comment">//1.å½“å‰ç”¨æˆ·çš„ç”¨æˆ·å</span>
        <span class="token comment">//1.å½“å‰ç”¨æˆ·çš„å¯†ç </span>
        <span class="token comment">//1.å½“å‰ç”¨æˆ·çš„æƒé™</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">,</span>
                        <span class="token class-name">AuthorityUtils</span><span class="token punctuation">.</span><span class="token function">commaSeparatedStringToAuthorityList</span><span class="token punctuation">(</span><span class="token string">"admin,normal"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™æ—¶å¯åŠ¨é¡¹ç›®ï¼Œç›´æ¥åœ¨SpringSecurityçš„å†…ç½®ç™»å½•é¡µç™»å½•ï¼Œå¦‚æœè¾“å…¥ç”¨æˆ·åä¸º<strong>admin</strong>ï¼Œå¯†ç ä¸º<strong>123</strong>ï¼Œç™»å½•æ—¶ï¼Œå°±ä¸ä¼šæŠ¥<font color='red'>ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯</font>äº†ã€‚å…¶ä»–çš„éƒ½ä¼šæŠ¥<font color='red'>ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯</font></p>
<h3 id="è‡ªå®šä¹‰ç™»å½•é¡µé¢"><a href="#è‡ªå®šä¹‰ç™»å½•é¡µé¢" class="headerlink" title="è‡ªå®šä¹‰ç™»å½•é¡µé¢"></a>è‡ªå®šä¹‰ç™»å½•é¡µé¢</h3><p>è‡ªå®šä¹‰ç™»å½•é¡µé¢è¾ƒä¸ºç®€å•ï¼Œåªéœ€è¦é€šè¿‡ç»§æ‰¿WebSecurityConfigurerAdapteræ¥ä¿®æ”¹å®ƒçš„é»˜è®¤ç™»å½•é¡µé¢</p>
<p><strong>è‡ªå®šä¹‰ç™»å½•é¡µé¢ï¼š</strong>login.html</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/login<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    ç”¨æˆ·åï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    å¯†ç ï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ç™»å½•<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¸»é¡µï¼šmain.html</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>ç™»å½•æˆåŠŸ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç™»å½•å¤±è´¥é¡µé¢ï¼šerror.html</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>ç™»å½•å¤±è´¥<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/login.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç™»å½•å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>æ§åˆ¶ç±»ï¼š</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginController</span> <span class="token punctuation">&#123;</span>
   <span class="token comment">// @RequestMapping("/login")</span>
   <span class="token comment">// public String Login()&#123;</span>
   <span class="token comment">//    return "redirect:main.html";</span>
   <span class="token comment">// &#125;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/toMain"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"redirect:main.html"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/toError"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"redirect:error.html"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>é…ç½®ç±»ï¼š</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//é‡å†™configureæ–¹æ³•æ¥è‡ªå®šä¹‰ç™»å½•é¡µé¢</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è¡¨å•æäº¤</span>
       http<span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
               <span class="token comment">//ç™»å½•çš„URLï¼Œæ³¨ï¼šå¿…é¡»è¦ä¸å’±ä»¬è‡ªå®šä¹‰çš„ç™»å½•é¡µé¢çš„è¡¨å•è¯·æ±‚çš„æäº¤è·¯å¾„ action="è·¯å¾„" ä¸€è‡´ã€‚</span>
               <span class="token punctuation">.</span><span class="token function">loginProcessingUrl</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>
               <span class="token comment">//è‡ªå®šä¹‰ç™»å½•é¡µé¢</span>
               <span class="token punctuation">.</span><span class="token function">loginPage</span><span class="token punctuation">(</span><span class="token string">"/login.html"</span><span class="token punctuation">)</span>
               <span class="token comment">//ç™»å½•æˆåŠŸåè¦è·³è½¬çš„é¡µé¢ï¼Œå¿…é¡»æ˜¯Postè¯·æ±‚ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥å†™é¡µé¢ï¼Œè¦ç”¨controlleråšé¡µé¢è·³è½¬</span>
               <span class="token comment">//.successForwardUrl("/main.html");</span>
               <span class="token punctuation">.</span><span class="token function">successForwardUrl</span><span class="token punctuation">(</span><span class="token string">"/toMain"</span><span class="token punctuation">)</span>
              <span class="token comment">//ç™»å½•å¤±è´¥åè¦è·³è½¬çš„é¡µé¢ï¼Œä¹Ÿæ˜¯Postè¯·æ±‚,è¦ç”¨controlleråšé¡µé¢è·³è½¬</span>
               <span class="token punctuation">.</span><span class="token function">failureForwardUrl</span><span class="token punctuation">(</span><span class="token string">"/toError"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">//æˆæƒè®¤è¯</span>
        http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">//    æ”¾è¡Œï¼šç™»å½•é”™è¯¯é¡µ/error.htmlä¸éœ€è¦è®¤è¯</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/error.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">//     æ”¾è¡Œï¼š ç™»å½•é¡µ/login.htmlä¸éœ€è¦è®¤è¯</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/login.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">//æ”¾è¡Œé™æ€èµ„æº</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/js/**"</span><span class="token punctuation">,</span><span class="token string">"/css/**"</span><span class="token punctuation">,</span><span class="token string">"/images/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
                <span class="token comment">//æ”¾è¡Œç›®å½•ä¸‹çš„æ‰€æœ‰pngå›¾ç‰‡</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/**/*.png"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">//æ‰€æœ‰è¯·æ±‚éƒ½å¿…é¡»åœ¨è¢«è®¤è¯åï¼ˆç™»å½•åï¼‰ï¼Œæ‰èƒ½è¢«è®¿é—®</span>
                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token comment">//å½“è®¿é—®/login.htmlå’Œ/error.htmlç­‰ä»¥å¤–çš„å…¶ä»–è¯·æ±‚æ—¶ï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ°login.htmlé¡µé¢</span>

        <span class="token comment">//å…³é—­csrfé˜²æŠ¤</span>
        http<span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">PasswordEncoder</span> <span class="token function">getPw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token comment">//è¿”å›ä¸€ä¸ªPasswordEncoderå®ä¾‹</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="è®¾ç½®è¯·æ±‚è´¦å·å’Œå¯†ç çš„å‚æ•°å"><a href="#è®¾ç½®è¯·æ±‚è´¦å·å’Œå¯†ç çš„å‚æ•°å" class="headerlink" title="è®¾ç½®è¯·æ±‚è´¦å·å’Œå¯†ç çš„å‚æ•°å"></a>è®¾ç½®è¯·æ±‚è´¦å·å’Œå¯†ç çš„å‚æ•°å</h3><p>å› ä¸ºåœ¨SpringSecurityä¸­ï¼Œåœ¨æ‰§è¡Œè‡ªå®šä¹‰ç™»å½•é€»è¾‘çš„æ—¶å€™ï¼Œå…ˆä¼šæ‰§è¡Œä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œç™»å½•é¡µçš„ç”¨æˆ·åçš„å‚æ•°ånameå¿…é¡»ä¸ºusernameï¼Œå¯†ç çš„å‚æ•°ånameå¿…é¡»ä¸ºpasswordï¼Œä¸”ç™»å½•è¯·æ±‚ç±»å‹å¿…é¡»ä¸ºpostï¼Œ<font color='red'>æ‰€ä»¥å¦‚æœä½ åœ¨ç™»å½•é¡µä¸­çš„ç”¨æˆ·åå’Œå¯†ç ä½¿ç”¨äº†å…¶ä»–çš„å‚æ•°åï¼Œè¿‡æ»¤å™¨ä¾¿è·å–ä¸åˆ°ä¼ è¿‡æ¥çš„å‚æ•°çš„å€¼ï¼Œ</font>è¿‡æ»¤å™¨éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UsernamePasswordAuthenticationFilter</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractAuthenticationProcessingFilter</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SPRING_SECURITY_FORM_USERNAME_KEY <span class="token operator">=</span> <span class="token string">"username"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SPRING_SECURITY_FORM_PASSWORD_KEY <span class="token operator">=</span> <span class="token string">"password"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">AntPathRequestMatcher</span> DEFAULT_ANT_PATH_REQUEST_MATCHER <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AntPathRequestMatcher</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> <span class="token string">"POST"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//ç”¨æˆ·åçš„å‚æ•°å</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> usernameParameter <span class="token operator">=</span> <span class="token string">"username"</span><span class="token punctuation">;</span>
    <span class="token comment">//å¯†ç çš„å‚æ•°å</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> passwordParameter <span class="token operator">=</span> <span class="token string">"password"</span><span class="token punctuation">;</span>
    <span class="token comment">//åªå…è®¸postè¯·æ±‚</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> postOnly <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¦‚æœæƒ³è¦è‡ªå®šä¹‰ç™»å½•é¡µçš„ç”¨æˆ·åå’Œå¯†ç çš„å‚æ•°åï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨é…ç½®ç±»ä¸­è¿›è¡Œå¦‚ä¸‹å£°æ˜ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è¡¨å•æäº¤</span>
       http<span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
               <span class="token comment">//è‡ªå®šä¹‰ç”¨æˆ·åå’Œå¯†ç çš„å‚æ•°å</span>
               <span class="token punctuation">.</span><span class="token function">usernameParameter</span><span class="token punctuation">(</span><span class="token string">"usernameDIY"</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">passwordParameter</span><span class="token punctuation">(</span><span class="token string">"passwordDIY"</span><span class="token punctuation">)</span>
              
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//è¿™æ ·ä¾¿å¯ä»¥åœ¨ç™»å½•é¡µé¢ä½¿ç”¨è‡ªå®šä¹‰çš„nameå‚æ•°åï¼š</span>
<span class="token comment">//      &lt;form action="/login" method="post"></span>
<span class="token comment">//        ç”¨æˆ·åï¼š&lt;input type="text" name="usernameDIY"></span>
<span class="token comment">//          å¯†ç ï¼š&lt;input type="password" name="passwordDIY"></span>
<span class="token comment">//               &lt;input type="submit" value="ç™»å½•"></span>
<span class="token comment">//           &lt;/form></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="è‡ªå®šä¹‰ç™»å½•æˆåŠŸ-å¤±è´¥å¤„ç†å™¨"><a href="#è‡ªå®šä¹‰ç™»å½•æˆåŠŸ-å¤±è´¥å¤„ç†å™¨" class="headerlink" title="è‡ªå®šä¹‰ç™»å½•æˆåŠŸ/å¤±è´¥å¤„ç†å™¨"></a>è‡ªå®šä¹‰ç™»å½•æˆåŠŸ/å¤±è´¥å¤„ç†å™¨</h3><p>å¯¹äºå‰åç«¯åˆ†ç¦»é¡¹ç›®è€Œè¨€ï¼Œç™»å½•æˆåŠŸåä¸èƒ½ç›´æ¥ä½¿ç”¨controlleræ¥è¿›è¡Œè·³è½¬ï¼Œå…¶éœ€è¦ä¸€ä¸ªçœŸæ­£çš„URLè·¯å¾„</p>
<p><font color='red'>å®ç°AuthenticationSuccessHandlerå’ŒAuthenticationFailureHandlerï¼š</font></p>
<p><strong>1.ç™»å½•æˆåŠŸå¤„ç†å™¨ï¼šAuthenticationSuccessHandler</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAuthenticationSuccessHandler</span> <span class="token keyword">implements</span> <span class="token class-name">AuthenticationSuccessHandler</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span><span class="token comment">//ç™»å½•æˆåŠŸè¦è·³è½¬çš„URL</span>
    <span class="token keyword">public</span> <span class="token class-name">MyAuthenticationSuccessHandler</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token operator">=</span>url<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAuthenticationSuccess</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> httpServletRequest<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> httpServletResponse<span class="token punctuation">,</span> <span class="token class-name">Authentication</span> authentication<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">&#123;</span>
        httpServletResponse<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">/* //å¯ä»¥é€šè¿‡authenticationè·å–å½“å‰ç”¨æˆ·çš„ä¿¡æ¯
        User user= (User) authentication.getPrincipal();
        System.out.println(user.getUsername());
        //è€ƒè™‘åˆ°å®‰å…¨é—®é¢˜ï¼Œå¯†ç ä¸ä¼šæ‰“å°å‡ºæ¥ï¼Œåªä¼šæ‰“å°null
        System.out.println(user.getPassword());
        System.out.println(user.getAuthorities());*/</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>2.ç™»å½•å¤±è´¥å¤„ç†å™¨ï¼šAuthenticationFailureHandler</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAuthenticationFailureHandler</span> <span class="token keyword">implements</span> <span class="token class-name">AuthenticationFailureHandler</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span><span class="token comment">//ç™»å½•å¤±è´¥è¦è·³è½¬çš„URL</span>
    <span class="token keyword">public</span> <span class="token class-name">MyAuthenticationFailureHandler</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token operator">=</span>url<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAuthenticationFailure</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> httpServletRequest<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> httpServletResponse<span class="token punctuation">,</span> <span class="token class-name">AuthenticationException</span> e<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">&#123;</span>
        httpServletResponse<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>3.ä½¿ç”¨ï¼šsuccessHandler/failureHandler</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//é‡å†™configureæ–¹æ³•æ¥è‡ªå®šä¹‰ç™»å½•é¡µé¢</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è¡¨å•æäº¤</span>
       http<span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                   
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
                  
         
         <span class="token comment">// .successForwardUrl("/toMain")</span>
         <span class="token comment">//ç™»å½•æˆåŠŸåçš„å¤„ç†å™¨ï¼Œä¸èƒ½ä¸successForwardUrlå…±å­˜ï¼Œå¦åˆ™ä¼šæŠ¥é”™</span>
         <span class="token comment">// .successHandler(new MyAuthenticationSuccessHandler("main.html"))</span>
         <span class="token punctuation">.</span><span class="token function">successHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyAuthenticationSuccessHandler</span><span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//ç™»å½•æˆåŠŸåè·³è½¬åˆ°ç™¾åº¦</span>
        <span class="token comment">//ç™»å½•å¤±è´¥åçš„å¤„ç†å™¨ï¼Œä¸èƒ½ä¸successForwardUrlå…±å­˜ï¼Œå¦åˆ™ä¼šæŠ¥é”™</span>
        <span class="token punctuation">.</span><span class="token function">failureHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyAuthenticationFailureHandler</span><span class="token punctuation">(</span><span class="token string">"error.html"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç™»å½•åè¦è·³è½¬çš„é¡µé¢ï¼Œæ— éœ€ç»è¿‡controllerè·³è½¬</span>
        <span class="token comment">//.failureForwardUrl("/toError");</span>

            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">PasswordEncoder</span> <span class="token function">getPw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token comment">//è¿”å›ä¸€ä¸ªPasswordEncoderå®ä¾‹</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="regexMatchersè¯¦è§£"><a href="#regexMatchersè¯¦è§£" class="headerlink" title="regexMatchersè¯¦è§£"></a>regexMatchersè¯¦è§£</h3><p>regexMatchersä¸antMatchersä¸åŒçš„æ˜¯ï¼š</p>
<p>antMatchersçš„å‚æ•°æ˜¯antPatternsï¼Œè€ŒregexMatchersçš„å‚æ•°æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚</p>
<p>å¦‚ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    
        <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/js/**"</span><span class="token punctuation">,</span><span class="token string">"/css/**"</span><span class="token punctuation">,</span><span class="token string">"/images/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
        <span class="token comment">//æ”¾è¡Œç›®å½•ä¸‹çš„æ‰€æœ‰pngå›¾ç‰‡</span>
        <span class="token punctuation">.</span><span class="token function">onMatchers</span><span class="token punctuation">(</span><span class="token string">"/**/*.png"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">//æ”¾è¡Œæ‰€æœ‰jpgå›¾ç‰‡</span>
        <span class="token punctuation">.</span><span class="token function">regexMatchers</span><span class="token punctuation">(</span><span class="token string">".+[.]jpg"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">//æ‰€æœ‰è¯·æ±‚éƒ½å¿…é¡»åœ¨è¢«è®¤è¯åï¼ˆç™»å½•åï¼‰ï¼Œæ‰èƒ½è¢«è®¿é—®</span>
        <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¦å¤–ï¼ŒregexMatchersè¿˜æœ‰ä¸€ä¸ªåŒå‚æ•°çš„ç”¨æˆ·ï¼š</p>
<p>æ¯”å¦‚æœ‰ä¸ªGETæ–¹å¼çš„controllerè¯·æ±‚ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/demo"</span><span class="token punctuation">)</span>
  <span class="token annotation punctuation">@ResponseBody</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token string">"demo"</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">   <span class="token comment">//HttpMethodæŒ‡å®šæ”¾è¡Œçš„è¯·æ±‚çš„è¯·æ±‚æ–¹å¼</span>
<span class="token punctuation">.</span><span class="token function">regexMatchers</span><span class="token punctuation">(</span><span class="token class-name">HttpMethod</span><span class="token punctuation">.</span><span class="token class-name">Post</span><span class="token punctuation">,</span><span class="token string">"/demo"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//è¡¨ç¤ºæ”¾è¡Œè¯·æ±‚ç±»å‹ä¸ºPostçš„è¯·æ±‚/demo</span>
    <span class="token comment">//è€Œcontrollerä¸­çš„ /demo è¯·æ±‚ä¸ºGETç±»å‹ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬è®¿é—®/demoæ—¶ä¹Ÿä¼šè¢«æ‹¦æˆª</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="æƒé™åˆ¤æ–­"><a href="#æƒé™åˆ¤æ–­" class="headerlink" title="æƒé™åˆ¤æ–­"></a>æƒé™åˆ¤æ–­</h3><h4 id="hasAuthority-String"><a href="#hasAuthority-String" class="headerlink" title="hasAuthority (String)"></a>hasAuthority (String)</h4><p>åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å…·æœ‰ç‰¹å®šçš„æƒé™ï¼Œç”¨æˆ·çš„æƒé™æ˜¯åœ¨è‡ªå®šä¹‰ç™»å½•é€»è¾‘ä¸­åˆ›å»ºUserå¯¹è±¡æ—¶æŒ‡å®šçš„ï¼Œæ³¨æ„ï¼š<font color='red'>æƒé™çš„ä¹¦å†™ä¸¥æ ¼åŒºåˆ†å¤§å°å†™</font></p>
<p>å¦‚ä¸‹ï¼šç»™å½“å‰ç”¨æˆ·èµ‹äºˆadminå’Œnomalçš„æƒé™ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">,</span>                     <span class="token class-name">AuthorityUtils</span><span class="token punctuation">.</span><span class="token function">commaSeparatedStringToAuthorityList</span><span class="token punctuation">(</span><span class="token string">"admin,normal"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>åœ¨é…ç½®ç±»ä¸­é€šè¿‡hasAuthorityï¼ˆâ€adminâ€ï¼‰è®¾ç½®å…·æœ‰adminæƒé™æ‰èƒ½è®¿é—®ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/main1.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAuthority</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="hasAnyAuthority-String-â€¦"><a href="#hasAnyAuthority-String-â€¦" class="headerlink" title="hasAnyAuthority(String â€¦)"></a>hasAnyAuthority(String â€¦)</h4><p>å¦‚æœç”¨æˆ·å…·å¤‡ç»™å®šæƒé™ä¸­çš„æŸä¸€ä¸ªï¼Œå°±å…è®¸è¢«è®¿é—®ã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/main1.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAuthority</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">,</span><span class="token string">"normal"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="è§’è‰²åˆ¤æ–­"><a href="#è§’è‰²åˆ¤æ–­" class="headerlink" title="è§’è‰²åˆ¤æ–­"></a>è§’è‰²åˆ¤æ–­</h3><p>ç”¨æˆ·çš„è§’è‰²ä¹Ÿæ˜¯åœ¨è‡ªå®šä¹‰ç™»å½•é€»è¾‘ä¸­åˆ›å»ºUserå¯¹è±¡æ—¶æŒ‡å®šçš„ï¼Œ<font color='red'>æ³¨æ„æŒ‡å®šç”¨æˆ·è§’è‰²çš„å›ºå®šå†™æ³•</font>ï¼š<strong>ROLE_xxxx</strong>ï¼Œ<font color='red'>xxxxè¡¨ç¤ºè§’è‰²å</font></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">,</span>                     <span class="token class-name">AuthorityUtils</span><span class="token punctuation">.</span><span class="token function">commaSeparatedStringToAuthorityList</span><span class="token punctuation">(</span><span class="token string">"admin,normal,ROLE_admin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//ROLE_admin:ç®¡ç†å‘˜è§’è‰²</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="hasRole-String"><a href="#hasRole-String" class="headerlink" title="hasRole(String)"></a>hasRole(String)</h4><p>åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å…·æœ‰ç‰¹å®šçš„è§’è‰²ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//æ˜¯å¦å…·æœ‰ç®¡ç†å‘˜adminè§’è‰²</span>
<span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/main1.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="hasAnyRole-Stringâ€¦"><a href="#hasAnyRole-Stringâ€¦" class="headerlink" title="hasAnyRole( Stringâ€¦ )"></a>hasAnyRole( Stringâ€¦ )</h4><p>åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å…·æœ‰ç»™å®šè§’è‰²ä¸­çš„æŸä¸€ä¸ªçš„è§’è‰²ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/main1.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAnyRole</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">,</span><span class="token string">"ADmin"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><table>
<thead>
<tr>
<th align="center">è¡¨è¾¾å¼</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">hasRole</td>
<td align="center">ç”¨æˆ·å…·å¤‡æŸä¸ªè§’è‰²å³å¯è®¿é—®èµ„æº</td>
</tr>
<tr>
<td align="center">hasAnyRole</td>
<td align="center">ç”¨æˆ·å…·å¤‡å¤šä¸ªè§’è‰²ä¸­çš„ä»»æ„ä¸€ä¸ªå³å¯è®¿é—®èµ„æº</td>
</tr>
<tr>
<td align="center">hasAuthority</td>
<td align="center">ç±»ä¼¼äº hasRole</td>
</tr>
<tr>
<td align="center">hasAnyAuthority</td>
<td align="center">ç±»ä¼¼äº hasAnyRole</td>
</tr>
<tr>
<td align="center">permitAll</td>
<td align="center">ç»Ÿç»Ÿå…è®¸è®¿é—®</td>
</tr>
<tr>
<td align="center">denyAll</td>
<td align="center">ç»Ÿç»Ÿæ‹’ç»è®¿é—®</td>
</tr>
<tr>
<td align="center">isAnonymous</td>
<td align="center">åˆ¤æ–­æ˜¯å¦åŒ¿åç”¨æˆ·</td>
</tr>
<tr>
<td align="center">isAuthenticated</td>
<td align="center">åˆ¤æ–­æ˜¯å¦è®¤è¯æˆåŠŸ</td>
</tr>
<tr>
<td align="center">isRememberMe</td>
<td align="center">åˆ¤æ–­æ˜¯å¦é€šè¿‡è®°ä½æˆ‘ç™»å½•çš„</td>
</tr>
<tr>
<td align="center">isFullyAuthenticated</td>
<td align="center">åˆ¤æ–­æ˜¯å¦ç”¨æˆ·å/å¯†ç ç™»å½•çš„</td>
</tr>
<tr>
<td align="center">principle</td>
<td align="center">å½“å‰ç”¨æˆ·</td>
</tr>
<tr>
<td align="center">authentication</td>
<td align="center">ä» SecurityContext ä¸­æå–å‡ºæ¥çš„ç”¨æˆ·å¯¹è±¡</td>
</tr>
</tbody></table>
<h3 id="IPåœ°å€åˆ¤æ–­"><a href="#IPåœ°å€åˆ¤æ–­" class="headerlink" title="IPåœ°å€åˆ¤æ–­"></a>IPåœ°å€åˆ¤æ–­</h3><p>æŒ‡å®šæœ‰æƒè®¿é—®çš„æœåŠ¡å™¨IPåœ°å€ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/main1.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasIpAddress</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è·å–IPåœ°å€å¯ä»¥å¤„ç†å™¨ä¸­è°ƒç”¨getRemoteAddr()æ–¹æ³•ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAuthenticationSuccessHandler</span> <span class="token keyword">implements</span> <span class="token class-name">AuthenticationSuccessHandler</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span><span class="token comment">//ç™»å½•æˆåŠŸè¦è·³è½¬çš„URL</span>
    <span class="token keyword">public</span> <span class="token class-name">MyAuthenticationSuccessHandler</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token operator">=</span>url<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAuthenticationSuccess</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> httpServletRequest<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> httpServletResponse<span class="token punctuation">,</span> <span class="token class-name">Authentication</span> authentication<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">&#123;</span>
        httpServletResponse<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è·å–ipåœ°å€--------------------------------------ï¼š</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>httpServletRequest<span class="token punctuation">.</span><span class="token function">getRemoteAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="è‡ªå®šä¹‰403å¤„ç†æ–¹æ¡ˆ"><a href="#è‡ªå®šä¹‰403å¤„ç†æ–¹æ¡ˆ" class="headerlink" title="è‡ªå®šä¹‰403å¤„ç†æ–¹æ¡ˆ"></a>è‡ªå®šä¹‰403å¤„ç†æ–¹æ¡ˆ</h3><h4 id="ç¬¬ä¸€æ­¥ï¼šå®ç°AccessDeniedHandler"><a href="#ç¬¬ä¸€æ­¥ï¼šå®ç°AccessDeniedHandler" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šå®ç°AccessDeniedHandler"></a>ç¬¬ä¸€æ­¥ï¼šå®ç°AccessDeniedHandler</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAccessDeniedHandler</span> <span class="token keyword">implements</span> <span class="token class-name">AccessDeniedHandler</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> httpServletRequest<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> httpServletResponse<span class="token punctuation">,</span> <span class="token class-name">AccessDeniedException</span> e<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è®¾ç½®403çš„çŠ¶æ€ç ï¼ŒSC_FORBIDDEN</span>
        httpServletResponse<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">.</span>SC_FORBIDDEN<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®å“åº”çš„è¯·æ±‚å¤´</span>
        httpServletResponse<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span><span class="token string">"application/json;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®æ— æƒè®¿é—®æ—¶é¡µé¢å“åº”æ•°æ®</span>
        <span class="token class-name">PrintWriter</span> writer<span class="token operator">=</span>httpServletResponse<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"&#123;\"status\":\"error\",\"msg\":\"æƒé™ä¸è¶³ï¼Œè¯·è”ç³»ç®¡ç†å‘˜\"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="ç¬¬äºŒæ­¥ï¼šé…ç½®"><a href="#ç¬¬äºŒæ­¥ï¼šé…ç½®" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šé…ç½®"></a>ç¬¬äºŒæ­¥ï¼šé…ç½®</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MyAccessDeniedHandler</span> myAccessDeniedHandler<span class="token punctuation">;</span>
    <span class="token comment">//é‡å†™configureæ–¹æ³•æ¥è‡ªå®šä¹‰ç™»å½•é¡µé¢</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
    
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
            
        <span class="token comment">//403å¤„ç†-----------------------------------</span>
        http<span class="token punctuation">.</span><span class="token function">exceptionHandling</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">accessDeniedHandler</span><span class="token punctuation">(</span>myAccessDeniedHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å½“æ— æƒè®¿é—®æ—¶ï¼Œæ‰“å°å‡ºå¦‚ä¸‹æ•°æ®ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;&quot;status&quot;:&quot;error&quot;,&quot;msg&quot;:&quot;æƒé™ä¸è¶³ï¼Œè¯·è”ç³»ç®¡ç†å‘˜&quot;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="Donate" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">ç»™ä¸ªé¥­é’±ï¼Ÿ</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://i.loli.net/2020/12/23/J2Sv6rVeLtAPiHx.jpg"><img loading="lazy" src="https://i.loli.net/2020/12/23/J2Sv6rVeLtAPiHx.jpg" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://i.loli.net/2020/12/23/4rBXF1deMD6KyN8.png"><img loading="lazy" src="https://i.loli.net/2020/12/23/4rBXF1deMD6KyN8.png" alt="QQ æ”¯ä»˜" title="QQ æ”¯ä»˜"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://i.loli.net/2020/12/23/XvirFV3o6GyRMZU.png"><img loading="lazy" src="https://i.loli.net/2020/12/23/XvirFV3o6GyRMZU.png" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>Sovzn</li><li class="post-copyright-link"><strong>Post link: </strong><a href="http://sovzn.github.io/2021/04/19/SpringSecurity-01/" title="SpringSecurity_01">http://sovzn.github.io/2021/04/19/SpringSecurity-01/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless otherwise stated.</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/05/07/SpringSecurity-02/" rel="prev" title="SpringSecurity-02"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">SpringSecurity-02</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/04/17/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="next" title="Javaè®¾è®¡æ¨¡å¼"><span class="post-nav-text">Javaè®¾è®¡æ¨¡å¼</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>ç‚¹å‡»æŒ‰é’®è·³è½¬ GitHub Issues è¯„è®ºã€‚</span><br><span>è‹¥æ²¡æœ‰æœ¬æ–‡ Issueï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Comment æ¨¡ç‰ˆæ–°å»ºã€‚</span><br><a class="hty-button hty-button--raised" id="github-issues" target="_blank" rel="noopener" href="https://github.com/YunYouJun/yunyoujun.github.io/issues?q=is:issue+SpringSecurity_01">GitHub Issues</a></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 â€“ 2026 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Sovzn</span></div><div class="live_time"><span>æœ¬åšå®¢å·²è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  window.setTimeout(blog_live_time, 1000);
  const start = new Date('2020-04-12T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div id="local-search-result"></div></div></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script></body></html>